{"title":"Day 1 â€“ Spatial & Spatio-temporal Modelling","markdown":{"yaml":{"title":"Day 1 â€“ Spatial & Spatio-temporal Modelling","author":"Olatunji Johnson","bibliography":"references.bib","format":{"revealjs":{"theme":"simple","slide-number":true,"toc":false},"beamer":{"theme":"default","aspectratio":169,"include-in-header":"beamer-header.tex"}}},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n\n\n\n\n------------------------------------------------------------------------\n\n## About me\n\n-   Completed a Bachelor's degree in Statistics at FUTA\n-   Master's in Mathamatical Sciences at AIMS-Tanzania\n-   PhD in Statistics and Epidemiology at University of Lancaster\n-   Postdoc at University of Manchester\n-   Lecturer in Statistics at the University of Manchester\n\n\n------------------------------------------------------------------------\n\n## Overview of the 3 days\n\n-   Spatial and spatio-temporal analysis (different likelihoods)\n-   Joint modelling of multiple malaria processes\n-   Non-stationary spatial processes\n-   Hybrid machine learning + geostatistical models\n\n\n------------------------------------------------------------------------\n\n## Linear Regression\n\n-   Goal: Model a continuous response variable as a linear function of predictors.\n-   Model $Y = X \\beta + \\epsilon$, where $\\epsilon \\sim N(0, \\sigma^2)$\n-   Key Assumption\n    -   Linearity\n    -   Independence\n    -   Homoscedasticity (constant variance)\n    -   Normality of errors\n\n\n------------------------------------------------------------------------\n\n## Generalized Linear Models (GLMs)\n\n-   Extension of linear models to handle non-normal response distributions.\n-   Three components:\n    -   Random component: Distribution from the exponential family (e.g., Binomial, Poisson).\n    -   Systematic component: Linear predictor $\\eta = X\\beta$.\n    -   Link function: Relates $E(Y)$ to  $\\eta$.\n-   Examples:\n    -   Logistic regression for binary outcomes â€“ [`logit link function`]{style=\"color: blue;\"}\n    -   Poisson regression for count data â€“ [`log link function`]{style=\"color: blue;\"}\n\n\n::: {.smaller}\n## Why Spatial Statistics?\n\n-   **Spatial Dependence:**\\\n    Observations collected at nearby locations are often more similar than those farther apart.\n\n-   **Ignoring Spatial Structure:**\n\n    -   Leads to biased parameter estimates.\n    -   Underestimates uncertainty.\n    -   Misses important spatial patterns.\n\n-   **Applications:**\n\n    -   Disease mapping\\\n    -   Environmental monitoring\\\n    -   Agricultural field trials\n\n-   **Goal:**\\\n    Account for spatial correlation to improve prediction and inference.\n:::\n\n\n# Spatial Analysis\n\n------------------------------------------------------------------------\n\n## Spatial Statistics\n\n::: columns\n::: column\n![Cressie 1991](images2/cressie2.png){fig-align=\"center\"}\n:::\n\n::: column\n![Gelfand 2010](images2/gelfand.png){fig-align=\"center\"}\n:::\n:::\n\n::: {.smaller}\n\n## Classification of spatial statistics\n\nCressieâ€™s book classifies spatial statistics according to **data format**:\n\n1. Geostatistical data  \n2. Lattice data  \n3. Point patterns  \n\nGelfandâ€™s book classifies spatial statistics according to **spatial variation**:\n\n1. Discrete spatial variation: Gaussian Markov Random Field (GMRF)  \n2. Continuous spatial variation: Gaussian Random Field (GMRF)  \n\n::: \n\n\n## Geostatistical data: River blindness in Cameroon\n\n![Geostatistical data: River blindness in Cameroon](images2/check.png){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## Lattice Data: COPD emergency admission\n\n![Lattice data: COPD emergency admission](images2/incidence_rate.png){fig-align=\"center\"}\n\n\n------------------------------------------------------------------------\n\n## Point pattern: Primary biliary cirrhosis data\n\n![Point pattern: Primary biliary cirrhosis data](images2/point_map2.png){fig-align=\"center\"}\n\n\n# Model-based Geostatistics\n\n------------------------------------------------------------------------\n\n## Modelling Geostatistical Data â€“ Model-based Geostatistics\n\n- The term **Model-based Geostatistics (MBG)** was coined by Peter Diggle in 1998 [@diggle1998model; @diggle2019model].\n- MBG applies general principles of statistical modelling and inference to the analysis of geostatistical data.\n- It emphasises the use of likelihood-based inference.\n- **[and the use of latent spatial process (Gaussian or stochastic process)]{style=\"color:red;\"}**\n\n\n------------------------------------------------------------------------\n\n## Standard MBG model\n\n$$\nY_i = \\beta_0 \n+ \\underbrace{\\beta_1 d_1(x_i) + \\beta_2 d_2(x_i)}_{\\text{explained}}\n+ \\underbrace{S(x_i) + Z_j}_{\\text{unexplained}},\n$$\n\nwhere\n\n- $\\beta_0$, $\\beta_1$, and $\\beta_2$ are regression coefficients;\n- $d_1(x)$ and $d_2(x)$ denote covariates/predictors at location $x$;\n- $S(x)$ is the stochastic spatial process;\n- $Z_j$ represents measurement error.\n\n------------------------------------------------------------------------\n\n## Modelling $S(x)$ and $Z_j$\n\n- $Z_i \\sim N(0, \\tau^2)$\n- We assume that $S(x)$ is a zero-mean **[stationary and isotropic Gaussian process]{style=\"color:blue;\"}**. i.e $S \\sim \\text{MVN}(0, \\Sigma)$\n- The $(i,j)$th entry of $\\Sigma$ is\n  $$\n  \\Sigma_{ij} = \\operatorname{Cov}\\big(S(x_i), S(x_j)\\big) = \\sigma^2 \\rho(u)\n  $$\n- $u = \\|x_i - x_j\\|$ is the Euclidean distance between locations $x_i$ and $x_j$\n- **[How do we choose parametric correlation function $\\rho(\\cdot)$?]{style=\"color:blue;\"}**\n\n\n\n::: {.smaller}\n## The MatÃ©rn correlation function\n\n$$\n\\rho(u; \\phi, \\kappa)\n= \\frac{1}{2^{\\kappa-1}\\Gamma(\\kappa)}\n\\left(\\frac{u}{\\phi}\\right)^\\kappa\nK_\\kappa\\!\\left(\\frac{u}{\\phi}\\right),\n$$\n\n- $K_\\kappa(\\cdot)$: modified Bessel function of order $\\kappa$\n\n- **[Interpretation]{style=\"color:red;\"}**\n  - $\\kappa$ determines the smoothness:\n    $\\kappa > r \\Rightarrow S(x)$ is $r$ times differentiable\n  - $\\phi$ determines the scale of spatial correlation\n\n- **[Special cases]{style=\"color:red;\"}**\n  - $\\kappa = 0.5 \\Rightarrow \\rho(u) = \\exp\\{-u/\\phi\\}$\n  - $\\kappa \\to \\infty \\Rightarrow \\rho(u) = \\exp\\{-(u/\\phi)^2\\}$\n\n- Often sufficient to choose $\\kappa \\in \\{0.5, 1.5, 2.5\\}$\n:::\n\n\n::: {.smaller}\n## MatÃ©rn correlation function â€“ $\\kappa$\n\n$$\n\\rho(u; \\phi, \\kappa)\n= \\frac{1}{2^{\\kappa-1}\\Gamma(\\kappa)}\n\\left(\\frac{u}{\\phi}\\right)^\\kappa\nK_\\kappa\\!\\left(\\frac{u}{\\phi}\\right),\n$$\n\n\n![](images2/correlationfuncplot1.png){width=50%}\n\n\n**[Exponential correlation function:]{style=\"color:blue;\"}**\n$\\rho(u; \\phi, 0.5) = \\exp\\{-u/\\phi\\}$\n\n:::\n\n\n\n## The scale of the spatial correlation â€“ $\\phi$\n\n![](images2/spatial_cor){width=50%}\n\n\n---\n\n## Do we need the process $S(x)$?\n\n- Regression residuals  \n  $$\n  \\hat{r}_i = Y_i - \\hat{Y}_i\n  $$\n  from a GLM\n\n- Each $\\hat{r}_i$ estimates  \n  $$\n  S(x_i) + Z_i\n  $$\n\n::: {.smaller}\n\n## The variogram\n\n::: columns\n::: column\n- **Empirical variogram**\n  $$\n  \\hat{V}(u) = \\frac{1}{2|N(u)|}\\sum_{(i,j)\\in N(u)}(\\hat{r}_i-\\hat{r}_j)^2\n  $$\n\n- where  \n  $$\n  N(u)=\\{(i,j): \\lVert x_i-x_j\\rVert=u\\}\n  $$\n:::\n\n::: column\n::: {.text-end}\n![](images2/lead1997_vario){width=50%}\n:::\n:::\n:::\n\n:::\n\n::: {.smaller}\n\n## Confirming existence of spatial correlation\n\n::: columns\n::: column\n1. Randomly permute the $\\hat{r}_i$ while holding the locations $x$ fixed  \n2. Compute the empirical variogram using the permuted $\\hat{r}_i$  \n3. Repeat steps 1â€“2 $B$ times  \n4. Use the resulting $B$ variograms to compute **pointwise 95% tolerance bands** at each distance bin  \n5. If the observed variogram lies outside the 95% band, this indicates **residual spatial correlation**\n:::\n\n::: column\n![](images2/lead1997_permuted_vario){width=75%}\n:::\n:::\n\n:::\n\n\n\n::: {.smaller}\n\n## Inference: Maximum likelihood estimation\n\n- **[Multivariate Gaussian distribution]{style=\"color:red;\"}**  \n  $$\n  Y \\sim \\text{MVN}(D\\beta, \\sigma^2 R + \\tau^2 I)\n  $$\n\n  - $D$: matrix of covariates, $[D]_{ik} = d_k(x_i)$  \n  - $R$: spatial correlation matrix,  \n    $[R]_{ij} = \\rho(u_{ij})$, with $u_{ij} = \\|x_i - x_j\\|$\n\n- **[Fitting process]{style=\"color:red;\"}**\n  1. Initialise $\\beta$ (e.g. using ordinary least squares)\n  2. Initialise $\\theta$ (e.g. using the empirical variogram)\n  3. Maximise\n     $$\n     \\ell(\\theta) = \\log\\{f(y; \\beta, \\theta)\\},\n     $$\n     where $f(\\cdot; \\beta, \\theta)$ is the multivariate Gaussian density\n\n:::\n\n\n## Beyond Gaussian responses\n\nSo far, we assumed:\n$$\nY \\sim \\text{MVN}(D\\beta, \\sigma^2 R + \\tau^2 I)\n$$\n\nHowever, many geostatistical datasets are:\n\n- Binary (presence / absence)\n- Counts (number of cases)\n- Rates or proportions\n\nA **Gaussian likelihood is no longer appropriate**\n\n\n::: {.smaller}\n## Separating data and process models\n\nModel-based geostatistics distinguishes between:\n\n- **Observation model (likelihood):**\n  $$\n  Y_i \\mid \\eta_i \\sim \\pi(y_i \\mid \\eta_i)\n  $$\n\n- **Latent process model:**\n  $$\n  \\eta_i = X_i \\beta + S(x_i) + Z_i\n  $$\n\nKey idea:\n\n- Non-Gaussian data\n- Gaussian latent structure\n:::\n\n::: {.smaller}\n## Common likelihoods in practice\n\n- **Gaussian**\n  $$\n  Y_i \\mid \\eta_i \\sim N(\\eta_i, \\sigma^2)\n  $$\n  Continuous measurements (e.g. pollution levels)\n\n- **Binomial**\n  $$\n  Y_i \\mid \\eta_i \\sim \\text{Binomial}(n_i, p_i),\n  \\qquad \\text{logit}(p_i) = \\eta_i\n  $$\n  Prevalence survey data\n\n- **Poisson**\n  $$\n  Y_i \\mid \\eta_i \\sim \\text{Poisson}(\\lambda_i),\n  \\qquad \\log(\\lambda_i) = \\eta_i\n  $$\n  Disease counts, event data\n:::\n\n\n## Link functions\n\nThe linear predictor enters the likelihood via a link:\n\n$$\ng(\\mu_i) = \\eta_i = X_i\\beta + S(x_i) + Z_i\n$$\n\nExamples:\n\n- Identity link â†’ Gaussian data\n- Logit link â†’ Binomial data\n- Log link â†’ Poisson data\n\nThis gives a **generalized linear mixed model (GLMM)** structure\n\n\n::: {.smaller}\n\n## Computational challenges\n\nFor non-Gaussian likelihoods:\n\n- The marginal likelihood requires:\n  $$\n  L(\\theta) = \\int \\pi(y \\mid S, \\theta)\\pi(S \\mid \\theta)\\,dS\n  $$\n\n- High-dimensional integral over latent field $x$\n- No closed-form solution\n\nConsequences:\n\n- Maximum likelihood is expensive\n- Bayesian inference via MCMC is slow\n\n\n::: \n\n## Classical solutions and limitations\n\n- Laplace approximation\n- Penalised quasi-likelihood (PQL)\n- MCMC-based Bayesian inference\n\nLimitations:\n\n- Poor scalability for large spatial fields\n- Long runtimes\n- Difficult model exploration\n\n\n---\n\n## Key takeaway\n\nWe want:\n\n- Flexible likelihoods (Binomial, Poisson, etc.)\n- Spatial and spatio-temporal random effects\n- Bayesian inference\n- Computational efficiency\n\nThis motivates **Integrated Nested Laplace Approximation (INLA)**\n\n\n\n---\n\n## From likelihoods to INLA\n\nHierarchical models setup:\n\n- Data likelihood: possibly non-Gaussian\n- Latent field: Gaussian with spatial dependence\n- Hyperparameters: low-dimensional\n\nThis class of models is known as **Latent Gaussian Models**\n\nINLA is designed specifically for this class\n\n\n---\n\n## Why INLA?\n\n- Fully Bayesian inference for latent Gaussian models is often computationally expensive\n- Markov chain Monte Carlo (MCMC):\n  - Accurate but slow for large spatial datasets\n  - Poor scaling with dimension of latent field\n\n- **INLA** provides:\n  - Deterministic (non-sampling) approximation\n  - Orders-of-magnitude speed-ups\n  - Accurate marginal posterior distributions\n\n\n\n::: {.smaller}\n\n## Latent Gaussian models\n\nINLA is designed for **latent Gaussian models (LGMs)**:\n\n$$\ny_i \\mid \\eta_i, \\theta \\sim \\pi(y_i \\mid \\eta_i, \\theta),\n\\qquad\n\\eta = A S\n$$\n\nwhere\n\n- $S \\sim \\mathcal{N}(0, Q(\\theta)^{-1})$ is a latent Gaussian field\n- $A$ is a known design / projection matrix\n- $\\theta$ are low-dimensional hyperparameters\n\nExamples of $S$:\n\n  - Spatial Gaussian random fields\n  - Temporal effects\n  - Random effects and smoothers\n\n:::\n\n\n## Key idea: sparsity\n\n- Latent field $S$ is modelled as a **Gaussian Markov Random Field (GMRF)**\n- GMRFs have **sparse precision matrices** $Q(\\theta)$\n\nWhy this matters:\n\n- Sparse matrix algebra is fast\n- Enables scalable inference for large spatial problems\n- Crucial for INLAâ€™s computational efficiency\n\n\n\n::: {.smaller}\n\n## Stage 1: Hyperparameter inference\n\nGoal:\n$$\n\\pi(\\theta \\mid y) \\propto \\frac{\\pi(y \\mid S, \\theta)\\pi(S \\mid \\theta)\\pi(\\theta)}\n{\\pi(S \\mid y, \\theta)}\n$$\n\n- INLA uses a **Laplace approximation** to integrate out $S$\n- Produces an accurate approximation to:\n  $$\n  \\pi(\\theta \\mid y)\n  $$\n\nKey point:\n\n- $\\theta$ is low-dimensional â†’ numerical optimisation is feasible\n\n:::\n\n\n::: {.smaller}\n## Stage 2: Latent field given $\\theta$\n\n- Conditional on $\\theta$, INLA approximates:\n  $$\n  \\pi(S \\mid \\theta, y)\n  $$\n\n- Approximation:\n\n  - Gaussian\n  - Centered at the mode of the conditional posterior\n  - Uses local curvature (Hessian)\n\nThis step exploits:\n\n- Gaussian structure of $S$\n- Sparse precision matrix\n:::\n\n\n::: {.smaller}\n\n## Stage 3: Marginal posteriors\n\nFinal goal:\n$$\n\\pi(S_i \\mid y), \\qquad \\pi(\\theta_j \\mid y)\n$$\n\nINLA computes:\n$$\n\\pi(S_i \\mid y)\n=\n\\int \\pi(S_i \\mid \\theta, y)\\,\\pi(\\theta \\mid y)\\,d\\theta\n$$\n\n- Integration performed numerically\n- Output:\n\n  - Marginal posterior means\n  - Credible intervals\n  - Full marginal densities\n\n:::\n\n\n## GRF vs GMRF: concept vs computation \n\n@lindgren2011explicit provides the link between the two.\n\n- **Gaussian Random Field (GRF):**\n  - Defined on a continuous spatial domain\n  - Used for geostatistical modelling\n  - Dense covariance structure\n\n- **Gaussian Markov Random Field (GMRF):**\n  - Defined on a finite set of locations\n  - Sparse precision matrix\n  - Computationally efficient\n\nKey point:\n\nðŸ‘‰ In INLA, a **GMRF is used as a computational approximation**\nto a **continuous GRF**\n\n\n\n::: {.smaller}\n\n## Spatial modelling in INLA: SPDE approach\n\n- Continuous Gaussian random fields are represented via:\n  **Stochastic Partial Differential Equations (SPDEs)**\n\nKey ideas:\n\n- Start with a MatÃ©rn GRF (continuous)\n- Approximate it on a triangulated mesh\n- Obtain a **computational GMRF**\n- Retain MatÃ©rn covariance structure\n\nBenefits:\n\n- Sparse precision matrix\n- Fast Bayesian inference with INLA\n\n:::\n\n## Why the SPDE approach?\n\n- In geostatistics, we often model spatial dependence using\n  **Gaussian random fields (GRFs)** with MatÃ©rn covariance\n\n- For observations at locations $x_1, \\dots, x_n$:\n  - Covariance matrix is **dense**\n  - Computational cost is $\\mathcal{O}(n^3)$\n\nThis becomes infeasible for large spatial datasets\n\n\n---\n\n## Gaussian random fields\n\nA spatial Gaussian random field is defined as:\n\n$$\nS(x) \\sim \\text{GRF}(0, C(\\cdot))\n$$\n\nwith covariance function:\n$$\n\\text{Cov}\\{S(x), S(x')\\} = C(\\|x - x'\\|)\n$$\n\n- The MatÃ©rn family is widely used\n- Defined on a **continuous spatial domain**\n\n\n---\n\n## From covariance to SPDE\n\nA key result (Whittle, 1954):\n\nA MatÃ©rn GRF is the solution to the SPDE:\n$$\n(\\kappa^2 - \\Delta)^{\\alpha/2} S(x)\n= \\mathcal{W}(x),\n$$\n\nwhere:\n- $\\Delta$ is the Laplacian operator\n- $\\mathcal{W}(x)$ is Gaussian white noise\n- Parameters $(\\kappa, \\alpha)$ control range and smoothness\n\n\n::: {.smaller}\n\n## Discretising the SPDE\n\n- The spatial domain is discretised using a **triangular mesh**\n- The continuous field is approximated as:\n  $$\n  S(x) \\approx \\sum_{k=1}^K w_k \\psi_k(x)\n  $$\n\nwhere:\n\n- $\\psi_k(x)$ are basis functions\n- $w_k$ are random weights\n\nLocal support of basis functions â‡’ sparsity\n\n\n:::\n\n## From GRF to GMRF\n\n- The SPDE discretisation yields\n  $$\n  \\mathbf{w} \\sim \\mathcal{N}(0, Q^{-1})\n  $$\n\n- Precision matrix $Q$ is **sparse**\n- This defines a **Gaussian Markov Random Field (GMRF)**\n\nKey consequence:\n- Fast computation\n- Scales to large spatial problems\n\n---\n\n## SPDE approach: summary\n\n- Specify a MatÃ©rn Gaussian random field\n- Use its equivalent SPDE representation\n- Approximate the SPDE on a triangulated mesh\n- Obtain a sparse GMRF representation\n- Perform fast Bayesian inference using INLA\n\n\n---\n\n## When should you use INLA?\n\nINLA is well suited for:\n\n- Spatial and spatio-temporal models\n- Latent Gaussian models\n- Large datasets with structured dependence\n\nINLA is less suitable for:\n\n- Highly non-Gaussian latent structures\n- Very high-dimensional hyperparameter spaces\n- Models requiring full joint posterior samples\n\n\n\n::: {.smaller}\n\n## `INLA` and `inlabru` R packages\n\n**What is `inlabru`?**\n\n- An R package built on top of `INLA`\n- Designed for spatial and spatio-temporal modelling using  \n  **Integrated Nested Laplace Approximation (INLA)**\n- Provides an intuitive interface for:\n  - Spatial point process models\n  - Geostatistical models\n\n- Install `INLA`:  <https://www.r-inla.org/download-install>\n\n- Examples and documentation: <https://inlabru-org.github.io/inlabru/>\n\n**Key features**\n\n- Formula-based model specification\n- Flexible integration with `sf`, `sp`, and `raster`\n\n:::\n\n------------------------------------------------------------------------\n\n## References\n\n","srcMarkdownNoYaml":"\n\n\n\n\n# Introduction\n\n------------------------------------------------------------------------\n\n## About me\n\n-   Completed a Bachelor's degree in Statistics at FUTA\n-   Master's in Mathamatical Sciences at AIMS-Tanzania\n-   PhD in Statistics and Epidemiology at University of Lancaster\n-   Postdoc at University of Manchester\n-   Lecturer in Statistics at the University of Manchester\n\n\n------------------------------------------------------------------------\n\n## Overview of the 3 days\n\n-   Spatial and spatio-temporal analysis (different likelihoods)\n-   Joint modelling of multiple malaria processes\n-   Non-stationary spatial processes\n-   Hybrid machine learning + geostatistical models\n\n\n------------------------------------------------------------------------\n\n## Linear Regression\n\n-   Goal: Model a continuous response variable as a linear function of predictors.\n-   Model $Y = X \\beta + \\epsilon$, where $\\epsilon \\sim N(0, \\sigma^2)$\n-   Key Assumption\n    -   Linearity\n    -   Independence\n    -   Homoscedasticity (constant variance)\n    -   Normality of errors\n\n\n------------------------------------------------------------------------\n\n## Generalized Linear Models (GLMs)\n\n-   Extension of linear models to handle non-normal response distributions.\n-   Three components:\n    -   Random component: Distribution from the exponential family (e.g., Binomial, Poisson).\n    -   Systematic component: Linear predictor $\\eta = X\\beta$.\n    -   Link function: Relates $E(Y)$ to  $\\eta$.\n-   Examples:\n    -   Logistic regression for binary outcomes â€“ [`logit link function`]{style=\"color: blue;\"}\n    -   Poisson regression for count data â€“ [`log link function`]{style=\"color: blue;\"}\n\n\n::: {.smaller}\n## Why Spatial Statistics?\n\n-   **Spatial Dependence:**\\\n    Observations collected at nearby locations are often more similar than those farther apart.\n\n-   **Ignoring Spatial Structure:**\n\n    -   Leads to biased parameter estimates.\n    -   Underestimates uncertainty.\n    -   Misses important spatial patterns.\n\n-   **Applications:**\n\n    -   Disease mapping\\\n    -   Environmental monitoring\\\n    -   Agricultural field trials\n\n-   **Goal:**\\\n    Account for spatial correlation to improve prediction and inference.\n:::\n\n\n# Spatial Analysis\n\n------------------------------------------------------------------------\n\n## Spatial Statistics\n\n::: columns\n::: column\n![Cressie 1991](images2/cressie2.png){fig-align=\"center\"}\n:::\n\n::: column\n![Gelfand 2010](images2/gelfand.png){fig-align=\"center\"}\n:::\n:::\n\n::: {.smaller}\n\n## Classification of spatial statistics\n\nCressieâ€™s book classifies spatial statistics according to **data format**:\n\n1. Geostatistical data  \n2. Lattice data  \n3. Point patterns  \n\nGelfandâ€™s book classifies spatial statistics according to **spatial variation**:\n\n1. Discrete spatial variation: Gaussian Markov Random Field (GMRF)  \n2. Continuous spatial variation: Gaussian Random Field (GMRF)  \n\n::: \n\n\n## Geostatistical data: River blindness in Cameroon\n\n![Geostatistical data: River blindness in Cameroon](images2/check.png){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## Lattice Data: COPD emergency admission\n\n![Lattice data: COPD emergency admission](images2/incidence_rate.png){fig-align=\"center\"}\n\n\n------------------------------------------------------------------------\n\n## Point pattern: Primary biliary cirrhosis data\n\n![Point pattern: Primary biliary cirrhosis data](images2/point_map2.png){fig-align=\"center\"}\n\n\n# Model-based Geostatistics\n\n------------------------------------------------------------------------\n\n## Modelling Geostatistical Data â€“ Model-based Geostatistics\n\n- The term **Model-based Geostatistics (MBG)** was coined by Peter Diggle in 1998 [@diggle1998model; @diggle2019model].\n- MBG applies general principles of statistical modelling and inference to the analysis of geostatistical data.\n- It emphasises the use of likelihood-based inference.\n- **[and the use of latent spatial process (Gaussian or stochastic process)]{style=\"color:red;\"}**\n\n\n------------------------------------------------------------------------\n\n## Standard MBG model\n\n$$\nY_i = \\beta_0 \n+ \\underbrace{\\beta_1 d_1(x_i) + \\beta_2 d_2(x_i)}_{\\text{explained}}\n+ \\underbrace{S(x_i) + Z_j}_{\\text{unexplained}},\n$$\n\nwhere\n\n- $\\beta_0$, $\\beta_1$, and $\\beta_2$ are regression coefficients;\n- $d_1(x)$ and $d_2(x)$ denote covariates/predictors at location $x$;\n- $S(x)$ is the stochastic spatial process;\n- $Z_j$ represents measurement error.\n\n------------------------------------------------------------------------\n\n## Modelling $S(x)$ and $Z_j$\n\n- $Z_i \\sim N(0, \\tau^2)$\n- We assume that $S(x)$ is a zero-mean **[stationary and isotropic Gaussian process]{style=\"color:blue;\"}**. i.e $S \\sim \\text{MVN}(0, \\Sigma)$\n- The $(i,j)$th entry of $\\Sigma$ is\n  $$\n  \\Sigma_{ij} = \\operatorname{Cov}\\big(S(x_i), S(x_j)\\big) = \\sigma^2 \\rho(u)\n  $$\n- $u = \\|x_i - x_j\\|$ is the Euclidean distance between locations $x_i$ and $x_j$\n- **[How do we choose parametric correlation function $\\rho(\\cdot)$?]{style=\"color:blue;\"}**\n\n\n\n::: {.smaller}\n## The MatÃ©rn correlation function\n\n$$\n\\rho(u; \\phi, \\kappa)\n= \\frac{1}{2^{\\kappa-1}\\Gamma(\\kappa)}\n\\left(\\frac{u}{\\phi}\\right)^\\kappa\nK_\\kappa\\!\\left(\\frac{u}{\\phi}\\right),\n$$\n\n- $K_\\kappa(\\cdot)$: modified Bessel function of order $\\kappa$\n\n- **[Interpretation]{style=\"color:red;\"}**\n  - $\\kappa$ determines the smoothness:\n    $\\kappa > r \\Rightarrow S(x)$ is $r$ times differentiable\n  - $\\phi$ determines the scale of spatial correlation\n\n- **[Special cases]{style=\"color:red;\"}**\n  - $\\kappa = 0.5 \\Rightarrow \\rho(u) = \\exp\\{-u/\\phi\\}$\n  - $\\kappa \\to \\infty \\Rightarrow \\rho(u) = \\exp\\{-(u/\\phi)^2\\}$\n\n- Often sufficient to choose $\\kappa \\in \\{0.5, 1.5, 2.5\\}$\n:::\n\n\n::: {.smaller}\n## MatÃ©rn correlation function â€“ $\\kappa$\n\n$$\n\\rho(u; \\phi, \\kappa)\n= \\frac{1}{2^{\\kappa-1}\\Gamma(\\kappa)}\n\\left(\\frac{u}{\\phi}\\right)^\\kappa\nK_\\kappa\\!\\left(\\frac{u}{\\phi}\\right),\n$$\n\n\n![](images2/correlationfuncplot1.png){width=50%}\n\n\n**[Exponential correlation function:]{style=\"color:blue;\"}**\n$\\rho(u; \\phi, 0.5) = \\exp\\{-u/\\phi\\}$\n\n:::\n\n\n\n## The scale of the spatial correlation â€“ $\\phi$\n\n![](images2/spatial_cor){width=50%}\n\n\n---\n\n## Do we need the process $S(x)$?\n\n- Regression residuals  \n  $$\n  \\hat{r}_i = Y_i - \\hat{Y}_i\n  $$\n  from a GLM\n\n- Each $\\hat{r}_i$ estimates  \n  $$\n  S(x_i) + Z_i\n  $$\n\n::: {.smaller}\n\n## The variogram\n\n::: columns\n::: column\n- **Empirical variogram**\n  $$\n  \\hat{V}(u) = \\frac{1}{2|N(u)|}\\sum_{(i,j)\\in N(u)}(\\hat{r}_i-\\hat{r}_j)^2\n  $$\n\n- where  \n  $$\n  N(u)=\\{(i,j): \\lVert x_i-x_j\\rVert=u\\}\n  $$\n:::\n\n::: column\n::: {.text-end}\n![](images2/lead1997_vario){width=50%}\n:::\n:::\n:::\n\n:::\n\n::: {.smaller}\n\n## Confirming existence of spatial correlation\n\n::: columns\n::: column\n1. Randomly permute the $\\hat{r}_i$ while holding the locations $x$ fixed  \n2. Compute the empirical variogram using the permuted $\\hat{r}_i$  \n3. Repeat steps 1â€“2 $B$ times  \n4. Use the resulting $B$ variograms to compute **pointwise 95% tolerance bands** at each distance bin  \n5. If the observed variogram lies outside the 95% band, this indicates **residual spatial correlation**\n:::\n\n::: column\n![](images2/lead1997_permuted_vario){width=75%}\n:::\n:::\n\n:::\n\n\n\n::: {.smaller}\n\n## Inference: Maximum likelihood estimation\n\n- **[Multivariate Gaussian distribution]{style=\"color:red;\"}**  \n  $$\n  Y \\sim \\text{MVN}(D\\beta, \\sigma^2 R + \\tau^2 I)\n  $$\n\n  - $D$: matrix of covariates, $[D]_{ik} = d_k(x_i)$  \n  - $R$: spatial correlation matrix,  \n    $[R]_{ij} = \\rho(u_{ij})$, with $u_{ij} = \\|x_i - x_j\\|$\n\n- **[Fitting process]{style=\"color:red;\"}**\n  1. Initialise $\\beta$ (e.g. using ordinary least squares)\n  2. Initialise $\\theta$ (e.g. using the empirical variogram)\n  3. Maximise\n     $$\n     \\ell(\\theta) = \\log\\{f(y; \\beta, \\theta)\\},\n     $$\n     where $f(\\cdot; \\beta, \\theta)$ is the multivariate Gaussian density\n\n:::\n\n\n## Beyond Gaussian responses\n\nSo far, we assumed:\n$$\nY \\sim \\text{MVN}(D\\beta, \\sigma^2 R + \\tau^2 I)\n$$\n\nHowever, many geostatistical datasets are:\n\n- Binary (presence / absence)\n- Counts (number of cases)\n- Rates or proportions\n\nA **Gaussian likelihood is no longer appropriate**\n\n\n::: {.smaller}\n## Separating data and process models\n\nModel-based geostatistics distinguishes between:\n\n- **Observation model (likelihood):**\n  $$\n  Y_i \\mid \\eta_i \\sim \\pi(y_i \\mid \\eta_i)\n  $$\n\n- **Latent process model:**\n  $$\n  \\eta_i = X_i \\beta + S(x_i) + Z_i\n  $$\n\nKey idea:\n\n- Non-Gaussian data\n- Gaussian latent structure\n:::\n\n::: {.smaller}\n## Common likelihoods in practice\n\n- **Gaussian**\n  $$\n  Y_i \\mid \\eta_i \\sim N(\\eta_i, \\sigma^2)\n  $$\n  Continuous measurements (e.g. pollution levels)\n\n- **Binomial**\n  $$\n  Y_i \\mid \\eta_i \\sim \\text{Binomial}(n_i, p_i),\n  \\qquad \\text{logit}(p_i) = \\eta_i\n  $$\n  Prevalence survey data\n\n- **Poisson**\n  $$\n  Y_i \\mid \\eta_i \\sim \\text{Poisson}(\\lambda_i),\n  \\qquad \\log(\\lambda_i) = \\eta_i\n  $$\n  Disease counts, event data\n:::\n\n\n## Link functions\n\nThe linear predictor enters the likelihood via a link:\n\n$$\ng(\\mu_i) = \\eta_i = X_i\\beta + S(x_i) + Z_i\n$$\n\nExamples:\n\n- Identity link â†’ Gaussian data\n- Logit link â†’ Binomial data\n- Log link â†’ Poisson data\n\nThis gives a **generalized linear mixed model (GLMM)** structure\n\n\n::: {.smaller}\n\n## Computational challenges\n\nFor non-Gaussian likelihoods:\n\n- The marginal likelihood requires:\n  $$\n  L(\\theta) = \\int \\pi(y \\mid S, \\theta)\\pi(S \\mid \\theta)\\,dS\n  $$\n\n- High-dimensional integral over latent field $x$\n- No closed-form solution\n\nConsequences:\n\n- Maximum likelihood is expensive\n- Bayesian inference via MCMC is slow\n\n\n::: \n\n## Classical solutions and limitations\n\n- Laplace approximation\n- Penalised quasi-likelihood (PQL)\n- MCMC-based Bayesian inference\n\nLimitations:\n\n- Poor scalability for large spatial fields\n- Long runtimes\n- Difficult model exploration\n\n\n---\n\n## Key takeaway\n\nWe want:\n\n- Flexible likelihoods (Binomial, Poisson, etc.)\n- Spatial and spatio-temporal random effects\n- Bayesian inference\n- Computational efficiency\n\nThis motivates **Integrated Nested Laplace Approximation (INLA)**\n\n\n\n---\n\n## From likelihoods to INLA\n\nHierarchical models setup:\n\n- Data likelihood: possibly non-Gaussian\n- Latent field: Gaussian with spatial dependence\n- Hyperparameters: low-dimensional\n\nThis class of models is known as **Latent Gaussian Models**\n\nINLA is designed specifically for this class\n\n\n---\n\n## Why INLA?\n\n- Fully Bayesian inference for latent Gaussian models is often computationally expensive\n- Markov chain Monte Carlo (MCMC):\n  - Accurate but slow for large spatial datasets\n  - Poor scaling with dimension of latent field\n\n- **INLA** provides:\n  - Deterministic (non-sampling) approximation\n  - Orders-of-magnitude speed-ups\n  - Accurate marginal posterior distributions\n\n\n\n::: {.smaller}\n\n## Latent Gaussian models\n\nINLA is designed for **latent Gaussian models (LGMs)**:\n\n$$\ny_i \\mid \\eta_i, \\theta \\sim \\pi(y_i \\mid \\eta_i, \\theta),\n\\qquad\n\\eta = A S\n$$\n\nwhere\n\n- $S \\sim \\mathcal{N}(0, Q(\\theta)^{-1})$ is a latent Gaussian field\n- $A$ is a known design / projection matrix\n- $\\theta$ are low-dimensional hyperparameters\n\nExamples of $S$:\n\n  - Spatial Gaussian random fields\n  - Temporal effects\n  - Random effects and smoothers\n\n:::\n\n\n## Key idea: sparsity\n\n- Latent field $S$ is modelled as a **Gaussian Markov Random Field (GMRF)**\n- GMRFs have **sparse precision matrices** $Q(\\theta)$\n\nWhy this matters:\n\n- Sparse matrix algebra is fast\n- Enables scalable inference for large spatial problems\n- Crucial for INLAâ€™s computational efficiency\n\n\n\n::: {.smaller}\n\n## Stage 1: Hyperparameter inference\n\nGoal:\n$$\n\\pi(\\theta \\mid y) \\propto \\frac{\\pi(y \\mid S, \\theta)\\pi(S \\mid \\theta)\\pi(\\theta)}\n{\\pi(S \\mid y, \\theta)}\n$$\n\n- INLA uses a **Laplace approximation** to integrate out $S$\n- Produces an accurate approximation to:\n  $$\n  \\pi(\\theta \\mid y)\n  $$\n\nKey point:\n\n- $\\theta$ is low-dimensional â†’ numerical optimisation is feasible\n\n:::\n\n\n::: {.smaller}\n## Stage 2: Latent field given $\\theta$\n\n- Conditional on $\\theta$, INLA approximates:\n  $$\n  \\pi(S \\mid \\theta, y)\n  $$\n\n- Approximation:\n\n  - Gaussian\n  - Centered at the mode of the conditional posterior\n  - Uses local curvature (Hessian)\n\nThis step exploits:\n\n- Gaussian structure of $S$\n- Sparse precision matrix\n:::\n\n\n::: {.smaller}\n\n## Stage 3: Marginal posteriors\n\nFinal goal:\n$$\n\\pi(S_i \\mid y), \\qquad \\pi(\\theta_j \\mid y)\n$$\n\nINLA computes:\n$$\n\\pi(S_i \\mid y)\n=\n\\int \\pi(S_i \\mid \\theta, y)\\,\\pi(\\theta \\mid y)\\,d\\theta\n$$\n\n- Integration performed numerically\n- Output:\n\n  - Marginal posterior means\n  - Credible intervals\n  - Full marginal densities\n\n:::\n\n\n## GRF vs GMRF: concept vs computation \n\n@lindgren2011explicit provides the link between the two.\n\n- **Gaussian Random Field (GRF):**\n  - Defined on a continuous spatial domain\n  - Used for geostatistical modelling\n  - Dense covariance structure\n\n- **Gaussian Markov Random Field (GMRF):**\n  - Defined on a finite set of locations\n  - Sparse precision matrix\n  - Computationally efficient\n\nKey point:\n\nðŸ‘‰ In INLA, a **GMRF is used as a computational approximation**\nto a **continuous GRF**\n\n\n\n::: {.smaller}\n\n## Spatial modelling in INLA: SPDE approach\n\n- Continuous Gaussian random fields are represented via:\n  **Stochastic Partial Differential Equations (SPDEs)**\n\nKey ideas:\n\n- Start with a MatÃ©rn GRF (continuous)\n- Approximate it on a triangulated mesh\n- Obtain a **computational GMRF**\n- Retain MatÃ©rn covariance structure\n\nBenefits:\n\n- Sparse precision matrix\n- Fast Bayesian inference with INLA\n\n:::\n\n## Why the SPDE approach?\n\n- In geostatistics, we often model spatial dependence using\n  **Gaussian random fields (GRFs)** with MatÃ©rn covariance\n\n- For observations at locations $x_1, \\dots, x_n$:\n  - Covariance matrix is **dense**\n  - Computational cost is $\\mathcal{O}(n^3)$\n\nThis becomes infeasible for large spatial datasets\n\n\n---\n\n## Gaussian random fields\n\nA spatial Gaussian random field is defined as:\n\n$$\nS(x) \\sim \\text{GRF}(0, C(\\cdot))\n$$\n\nwith covariance function:\n$$\n\\text{Cov}\\{S(x), S(x')\\} = C(\\|x - x'\\|)\n$$\n\n- The MatÃ©rn family is widely used\n- Defined on a **continuous spatial domain**\n\n\n---\n\n## From covariance to SPDE\n\nA key result (Whittle, 1954):\n\nA MatÃ©rn GRF is the solution to the SPDE:\n$$\n(\\kappa^2 - \\Delta)^{\\alpha/2} S(x)\n= \\mathcal{W}(x),\n$$\n\nwhere:\n- $\\Delta$ is the Laplacian operator\n- $\\mathcal{W}(x)$ is Gaussian white noise\n- Parameters $(\\kappa, \\alpha)$ control range and smoothness\n\n\n::: {.smaller}\n\n## Discretising the SPDE\n\n- The spatial domain is discretised using a **triangular mesh**\n- The continuous field is approximated as:\n  $$\n  S(x) \\approx \\sum_{k=1}^K w_k \\psi_k(x)\n  $$\n\nwhere:\n\n- $\\psi_k(x)$ are basis functions\n- $w_k$ are random weights\n\nLocal support of basis functions â‡’ sparsity\n\n\n:::\n\n## From GRF to GMRF\n\n- The SPDE discretisation yields\n  $$\n  \\mathbf{w} \\sim \\mathcal{N}(0, Q^{-1})\n  $$\n\n- Precision matrix $Q$ is **sparse**\n- This defines a **Gaussian Markov Random Field (GMRF)**\n\nKey consequence:\n- Fast computation\n- Scales to large spatial problems\n\n---\n\n## SPDE approach: summary\n\n- Specify a MatÃ©rn Gaussian random field\n- Use its equivalent SPDE representation\n- Approximate the SPDE on a triangulated mesh\n- Obtain a sparse GMRF representation\n- Perform fast Bayesian inference using INLA\n\n\n---\n\n## When should you use INLA?\n\nINLA is well suited for:\n\n- Spatial and spatio-temporal models\n- Latent Gaussian models\n- Large datasets with structured dependence\n\nINLA is less suitable for:\n\n- Highly non-Gaussian latent structures\n- Very high-dimensional hyperparameter spaces\n- Models requiring full joint posterior samples\n\n\n\n::: {.smaller}\n\n## `INLA` and `inlabru` R packages\n\n**What is `inlabru`?**\n\n- An R package built on top of `INLA`\n- Designed for spatial and spatio-temporal modelling using  \n  **Integrated Nested Laplace Approximation (INLA)**\n- Provides an intuitive interface for:\n  - Spatial point process models\n  - Geostatistical models\n\n- Install `INLA`:  <https://www.r-inla.org/download-install>\n\n- Examples and documentation: <https://inlabru-org.github.io/inlabru/>\n\n**Key features**\n\n- Formula-based model specification\n- Flexible integration with `sf`, `sp`, and `raster`\n\n:::\n\n------------------------------------------------------------------------\n\n## References\n\n"},"formats":{"revealjs":{"identifier":{"display-name":"RevealJS","target-format":"revealjs","base-format":"revealjs"},"execute":{"fig-width":10,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","html-math-method":{"method":"mathjax","url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS_HTML-full"},"slide-level":2,"to":"revealjs","toc":false,"output-file":"day1_slides.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":false,"quarto-version":"1.6.42","auto-stretch":true,"title":"Day 1 â€“ Spatial & Spatio-temporal Modelling","author":"Olatunji Johnson","bibliography":["references.bib"],"theme":"simple","slideNumber":true}},"beamer":{"identifier":{"display-name":"Beamer","target-format":"beamer","base-format":"beamer"},"execute":{"fig-width":10,"fig-height":7,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"beamer","include-in-header":["beamer-header.tex"],"output-file":"day1_slides.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"title":"Day 1 â€“ Spatial & Spatio-temporal Modelling","author":"Olatunji Johnson","bibliography":["references.bib"],"theme":"default","aspectratio":169},"classoption":["notheorems"]}},"projectFormats":["html"]}