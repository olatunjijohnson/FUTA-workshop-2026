{
  "hash": "9de559cb152880a51f2e52ad879228cc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Day 1 – Spatial & Spatio-temporal Modelling\"\nformat:\n  revealjs:\n    theme: simple\n    slide-number: true\n    toc: true\n  beamer:\n    theme: default        # Madrid works nicely; you can change later\n    aspectratio: 169\n    header-includes: |\n      \\usepackage{graphicx}\n      \\usepackage{xcolor}\n\n      % UoM-style purple (change hex if you have exact brand colour)\n      \\definecolor{uomPurple}{HTML}{6A1B9A}\n      \\setbeamercolor{structure}{fg=uomPurple}\n      \\setbeamercolor{title}{fg=uomPurple}\n      \\setbeamercolor{frametitle}{fg=uomPurple}\n\n      % Define the logo (file must be in the same folder as the .qmd/.tex)\n      \\newcommand{\\uomlogo}{\\includegraphics[height=1cm]{uom_logo.pdf}}\n\n      % Force logo into the top-right of every slide\n      \\setbeamertemplate{headline}{%\n        \\leavevmode%\n        \\hbox{%\n          \\begin{beamercolorbox}[wd=\\paperwidth,ht=1.2cm]{}\n            \\hfill\\uomlogo\\hspace{0.5cm}\n          \\end{beamercolorbox}%\n        }%\n      }\n\n      % Optional: add a bit of vertical space so the frametitle\n      % doesn't clash with the custom header\n      % \\addtobeamertemplate{frametitle}{}{%\n      %  \\vspace*{0.3cm}%\n      % }\nbibliography: references.bib\n---\n\n\n\n\n\n\n## About me\n\n-   Completed a Bachelor's degree in Statistics at FUTA\n-   Master's in Mathamatical Sciences at AIMS-Tanzania\n-   PhD in Statistics and Epidemiology at University of Lancaster\n-   Postdoc at University of Manchester\n-   Lecturer in Statistics at the University of Manchester\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n## Overview of the 3 days\n\n-   Spatial and spatio-temporal analysis (different likelihoods)\n-   Joint modelling of multiple malaria processes\n-   Non-stationary spatial processes\n-   Hybrid machine learning + geostatistical models\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n## Linear Regression\n\n-   Goal: Model a continuous response variable as a linear function of predictors.\n-   Model $Y = X \\beta + \\epsilon$, where $\\epsilon \\sim N(0, \\sigma^2)$\n-   Key Assumption\n    -   Linearity\n    -   Independence\n    -   Homoscedasticity (constant variance)\n    -   Normality of errors\\\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n## Generalized Linear Models (GLMs)\n\n-   Extension of linear models to handle non-normal response distributions.\n-   Three components:\n    -   Random component: Distribution from the exponential family (e.g., Binomial, Poisson).\n    -   Systematic component: Linear predictor $\\eta = X\\beta$.\n    -   Link function: Relates \\$\\\\mathbb{E}(Y) \\~\\~\\~ \\\\text{to} \\~\\~\\~ \\\\eta \\$.\n-   Examples:\n    -   Logistic regression for binary outcomes – [`logit link function`]{style=\"color: blue;\"}\n    -   Poisson regression for count data – [`log link function`]{style=\"color: blue;\"}\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n## Why Spatial Statistics?\n\n-   **Spatial Dependence:**\\\n    Observations collected at nearby locations are often more similar than those farther apart.\n\n-   **Ignoring Spatial Structure:**\n\n    -   Leads to biased parameter estimates.\n    -   Underestimates uncertainty.\n    -   Misses important spatial patterns.\n\n-   **Applications:**\n\n    -   Disease mapping\\\n    -   Environmental monitoring\\\n    -   Agricultural field trials\n\n-   **Goal:**\\\n    Account for spatial correlation to improve prediction and inference.\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n# Spatial Analysis\n\n------------------------------------------------------------------------\n\n## Spatial Statistics\n\n::: columns\n::: column\n![Cressie 1991](images2/cressie2){fig-align=\"center\"}\n:::\n\n::: column\n![Gelfand 2010](images2/gelfand){fig-align=\"center\"}\n:::\n:::\n\n------------------------------------------------------------------------\n\n## Classification of spatial statistics\n\nCressie’s book classifies spatial statistics according to **data format**:\n\n1. Geostatistical data  \n2. Lattice data  \n3. Point patterns  \n\nGelfand’s book classifies spatial statistics according to **spatial variation**:\n\n1. Discrete spatial variation  \n2. Continuous spatial variation  \n\n------------------------------------------------------------------------\n\n\n------------------------------------------------------------------------\n\n## Geostatistical data: River blindness in Cameroon\n\n![Geostatistical data: River blindness in Cameroon](images2/check){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n## Lattice Data: COPD emergency admission\n\n![Lattice data: COPD emergency admission](images2/incidence_rate){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\n\n## Point pattern: Primary biliary cirrhosis data\n\n![Point pattern: Primary biliary cirrhosis data](images2/point_map2){fig-align=\"center\"}\n\n------------------------------------------------------------------------\n\n# Model-based Geostatistics\n\n------------------------------------------------------------------------\n\n## Modelling Geostatistical Data – Model-based Geostatistics\n\n- The term **Model-based Geostatistics (MBG)** was coined by Peter Diggle in 1998 [@diggle1998model; @diggle2019model].\n- MBG applies general principles of statistical modelling and inference to the analysis of geostatistical data.\n- It emphasises the use of likelihood-based inference.\n- [`and the use of a latent spatial process (Gaussian or stochastic process)`]{style=\"color: red;\"}\n\n\n------------------------------------------------------------------------\n\n## Load the Data\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr) \nspatial_binom <- read_csv(\"../data/spatial_binomial_data.csv\")\nhead(spatial_binom)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 10\n     id   utm_x    utm_y n_tested n_pos prevalence_true      S elevation   ndvi\n  <dbl>   <dbl>    <dbl>    <dbl> <dbl>           <dbl>  <dbl>     <dbl>  <dbl>\n1     1 889932. 1109075.      185     5          0.0246 -2.47       342. 0.332 \n2     2 -55389. 1306167.      194    22          0.0757 -1.72       256. 0.670 \n3     3 511139. 1378888.       86    66          0.711   1.24       257. 0.714 \n4     4 388248. 1211845.      198   117          0.562   0.901      347. 0.496 \n5     5 212008. 1069276.      116    37          0.363   0.232      299. 0.303 \n6     6 240818.  594306.      164     6          0.0275 -2.13       326. 0.0851\n# ℹ 1 more variable: urban <dbl>\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}