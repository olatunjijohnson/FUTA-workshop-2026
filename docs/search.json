[
  {
    "objectID": "day1.html",
    "href": "day1.html",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "Today we introduce modern geostatistical modelling using inlabru, covering:\n\nSpatial models\n\nBinomial likelihood (prevalence)\nPoisson likelihood (case counts)\nSPDE spatial random fields\nPrediction surfaces\nExceedance probabilities\n\nSpatio-temporal models\n\nHandling time-indexed disease data\nRW1/RW2 temporal structure\nSpatio-temporal Gaussian fields\nPredicting in time and space\n\n\nThese form the foundation for Days 2 and 3.\n============================================================\nPART A — Spatial models\n============================================================\n\n\nThese data were generated during preprocessing and saved to data/\n\n\nCode\nlibrary(tidyverse)\nlibrary(INLA)\nlibrary(inlabru)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(stars)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\nnga_admin1 &lt;- ne_states(\"Nigeria\", returnclass = \"sf\") %&gt;%\nst_transform(32632)\n\nspatial_binom &lt;- read_csv(\"data/spatial_binomial_data.csv\")\nspatial_pois  &lt;- read_csv(\"data/spatial_poisson_data.csv\")\n\n\n\n\n\nWe need an sf layer to overlay boundaries, plot points, and feed coordinates into SPDE meshes.\n\n\nCode\nspatial_binom_sf &lt;- spatial_binom %&gt;%\n  st_as_sf(coords = c(\"utm_x\", \"utm_y\"), crs = 32632)\nspatial_pois_sf &lt;- spatial_pois %&gt;%\n  st_as_sf(coords = c(\"utm_x\", \"utm_y\"), crs = 32632)\n\n\n\n\n\nThis helps confirm:\n\nUTM conversion is correct\nPoints sit inside Nigeria\nPrevalence has spatial structure\n\n\n\nCode\nggplot() +\ngeom_sf(data = spatial_binom_sf, aes(colour = prevalence_true)) +\ngeom_sf(data = nga_admin1, fill = NA) +\nscale_colour_viridis_c(name=\"Prevalence\") +\ntheme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\nThe mesh defines the geometry on which the latent spatial field is approximated.\n\n\nCode\ncoords &lt;- st_coordinates(spatial_binom_sf)\n\nmesh &lt;- inla.mesh.2d(\nloc = coords,\nmax.edge = c(100000, 200000), # inner and outer triangle sizes\ncutoff = 20000,  # merge points closer than 20km\noffset = c(50000, 200000)  # extend mesh beyond convex hull\n)\n\nplot(mesh)\npoints(coords, col=\"red\", pch=16)\n\n\n\n\n\n\n\n\n\nA finer mesh → more accurate, more expensive.\nA coarser mesh → faster, less precise.\nWe balance cost vs smoothness.\n\n\n\nPenalised complexity (PC) priors make spatial models robust and interpretable.\n\n\nCode\nspde &lt;- inla.spde2.pcmatern(\nmesh = mesh,\nprior.range = c(300000, 0.5),\nprior.sigma = c(1.0, 0.01)\n)\n\n\n\n\n\nThe model is:\n\\[logit(pi​)=\\beta_0​+\\beta_1​ elevation_i​+ \\beta_2​ndvi_i​+ \\beta_3 ​urban_i​+ S(s_i​)\\]\nWhere \\(S(\\mathbf{s})\\) is a spatial Gaussian field.\n\n\nCode\ncomponents_binom &lt;- ~\nIntercept(1, model=\"linear\") +\nbeta_elev(elevation, model=\"linear\") +\nbeta_ndvi(ndvi, model=\"linear\") +\nbeta_urban(urban, model=\"linear\") +\nfield(geometry, model = spde)\n\nlik_binom &lt;- like(\nfamily=\"binomial\",\ndata=spatial_binom_sf,\nformula = n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban + field,\nNtrials = n_tested\n)\n\n#| cache: true\nfit_binom &lt;- bru(components_binom, lik_binom)\nsummary(fit_binom)\n\n\ninlabru version: 2.13.0.9024 \nINLA version: 25.12.02 \nLatent components:\nIntercept: main = linear(1)\nbeta_elev: main = linear(elevation)\nbeta_ndvi: main = linear(ndvi)\nbeta_urban: main = linear(urban)\nfield: main = spde(geometry)\nObservation models:\n  Model tag: &lt;No tag&gt;\n    Family: 'binomial'\n    Data class: 'sf', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban + field\n    Additive/Linear/Rowwise: TRUE/TRUE/TRUE\n    Used components: effect[Intercept, beta_elev, beta_ndvi, beta_urban, field], latent[] \nTime used:\n    Pre = 0.797, Running = 1.19, Post = 0.195, Total = 2.19 \nFixed effects:\n             mean    sd 0.025quant 0.5quant 0.975quant   mode kld\nIntercept  -3.464 0.779     -5.034   -3.452     -1.965 -3.453   0\nbeta_elev  -0.003 0.001     -0.006   -0.003      0.000 -0.003   0\nbeta_ndvi   5.350 1.305      2.796    5.340      7.962  5.341   0\nbeta_urban  0.456 0.059      0.341    0.456      0.572  0.456   0\n\nRandom effects:\n  Name    Model\n    field SPDE2 model\n\nModel hyperparameters:\n                    mean       sd 0.025quant 0.5quant 0.975quant     mode\nRange for field 2.79e+05 4.70e+04   2.01e+05 2.74e+05   3.86e+05 2.62e+05\nStdev for field 1.12e+00 1.34e-01   8.90e-01 1.11e+00   1.42e+00 1.08e+00\n\nMarginal log-Likelihood:  -935.76 \n is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')\n\n\n\n\n\nOften used for malaria case counts or incidence.\nModel: \\[\\log(\\lambda_i)= \\beta_0 + \\beta_1 X_i + S(s_i)\\]\n\n\nCode\ncomponents_pois &lt;- ~\nIntercept(1, model=\"linear\") +\nbeta_elev(elevation, model=\"linear\") +\nbeta_ndvi(ndvi, model=\"linear\") +\nbeta_urban(urban, model=\"linear\") +\nfield(geometry, model = spde)\n\nlik_pois &lt;- like(\nfamily=\"poisson\",\ndata=spatial_pois_sf,\nformula = cases ~ Intercept + beta_elev + beta_ndvi + beta_urban + field\n)\n\n#| cache: true\nfit_pois &lt;- bru(components_pois, lik_pois)\nsummary(fit_pois)\n\n\ninlabru version: 2.13.0.9024 \nINLA version: 25.12.02 \nLatent components:\nIntercept: main = linear(1)\nbeta_elev: main = linear(elevation)\nbeta_ndvi: main = linear(ndvi)\nbeta_urban: main = linear(urban)\nfield: main = spde(geometry)\nObservation models:\n  Model tag: &lt;No tag&gt;\n    Family: 'poisson'\n    Data class: 'sf', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: cases ~ Intercept + beta_elev + beta_ndvi + beta_urban + field\n    Additive/Linear/Rowwise: TRUE/TRUE/TRUE\n    Used components: effect[Intercept, beta_elev, beta_ndvi, beta_urban, field], latent[] \nTime used:\n    Pre = 0.752, Running = 0.933, Post = 0.246, Total = 1.93 \nFixed effects:\n             mean    sd 0.025quant 0.5quant 0.975quant   mode kld\nIntercept   0.530 0.617     -0.661    0.523      1.766  0.523   0\nbeta_elev  -0.001 0.002     -0.004   -0.001      0.002 -0.001   0\nbeta_ndvi   1.432 0.731     -0.063    1.449      2.829  1.448   0\nbeta_urban  0.747 0.082      0.587    0.747      0.909  0.747   0\n\nRandom effects:\n  Name    Model\n    field SPDE2 model\n\nModel hyperparameters:\n                    mean      sd 0.025quant 0.5quant 0.975quant     mode\nRange for field 1.34e+05 3.7e+04   7.56e+04 1.29e+05   2.20e+05 1.19e+05\nStdev for field 8.23e-01 9.4e-02   6.54e-01 8.18e-01   1.02e+00 8.07e-01\n\nMarginal log-Likelihood:  -631.40 \n is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')\n\n\n\n\n\n\n\nCode\npred_grid &lt;- read_csv(\"data/prediction_grid_utm.csv\") %&gt;%\nst_as_sf(coords=c(\"utm_x\",\"utm_y\"), crs=32632)\n\npred_binom &lt;- predict(\nfit_binom,\nnewdata = pred_grid,\nformula = ~ plogis(Intercept + beta_elev + beta_ndvi + beta_urban + field),\nn.samples = 1000\n)\n\n\nRasterise:\n\n\nCode\npred_binom_r &lt;- st_rasterize(pred_binom[\"mean\"], dx=10000, dy=10000)\npred_binom_r &lt;- pred_binom_r[st_union(nga_admin1)]\n\n\nPlot:\n\n\nCode\nggplot() +\n  geom_stars(data=pred_binom_r, na.rm = TRUE) +\n  scale_fill_viridis_c(name=\"Prev\", na.value = NA) +\n  geom_sf(data=nga_admin1, fill=NA) +\n  theme_minimal() +\n  theme(\n    panel.background = element_rect(fill = \"white\", colour = NA),\n    plot.background  = element_rect(fill = \"white\", colour = NA),\n    panel.grid       = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\n\nGoal:\n\\[P(prevalence&gt;0.5∣data)\\]\n\n\nCode\nexc_samples &lt;- generate(\nfit_binom,\nnewdata = pred_grid,\nformula = ~ plogis(Intercept + beta_elev + beta_ndvi + beta_urban + field),\nn.samples = 1000\n)\n\npred_binom$exc_prob &lt;- rowMeans(exc_samples &gt; 0.5)\n\n\nMap:\n\n\nCode\nexc_r &lt;- st_rasterize(pred_binom[\"exc_prob\"], dx=10000, dy=10000)\nexc_r &lt;- exc_r[st_union(nga_admin1)]\n\nggplot() +\n  geom_stars(data=exc_r, na.rm = TRUE) +\n  scale_fill_viridis_c(name=\"P(prev&gt;0.5)\", limits=c(0,1), na.value = NA) +\n  geom_sf(data=nga_admin1, fill=NA) +\n  theme_minimal() + \n  theme(\n    panel.background = element_rect(fill = \"white\", colour = NA),\n    plot.background  = element_rect(fill = \"white\", colour = NA),\n    panel.grid       = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n============================================================\nPART B — Spatio-Temporal Modelling ============================================================\nWe now extend:\n\\[S(s)⟶S(s,t)\\]\nA common structure:\n\nSpatial effect: SPDE\nTemporal effect: random walk (RW1 or RW2)\nInteraction: separable \\(S(s,t)=S_s(s)+S_t(t)\\)\n\n\n\nCode\nst_binom &lt;- read_csv(\"data/spatiotemporal_binomial_data.csv\") %&gt;%\n  st_as_sf(coords=c(\"utm_x\",\"utm_y\"), crs=32632)\n\nhead(st_binom)\n\n\nSimple feature collection with 6 features and 10 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 336995.7 ymin: 1047442 xmax: 336995.7 ymax: 1047442\nProjected CRS: WGS 84 / UTM zone 32N\n# A tibble: 6 × 11\n   site  time     S gamma_t elevation  ndvi urban n_tested n_pos prevalence_true\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;\n1     1     1 0.266   2.12       228. 0.305     0       63    51           0.774\n2     1     2 0.266   1.50       228. 0.305     0       65    43           0.649\n3     1     3 0.266   0.381      228. 0.305     0      119    52           0.376\n4     1     4 0.266   0.286      228. 0.305     0      191    72           0.354\n5     1     5 0.266   0.168      228. 0.305     0      180    50           0.327\n6     1     6 0.266   0.207      228. 0.305     0      155    52           0.336\n# ℹ 1 more variable: geometry &lt;POINT [m]&gt;\n\n\nShould contain:\n\ntime\nn_tested, n_pos\ncovariates\nUTM coordinates\n\n\n\n\nUse: - RW1 for time - SPDE for space - Additive interaction\n\n\nCode\ncomponents_st &lt;- ~\nIntercept(1, model=\"linear\") +\nbeta_elev(elevation, model=\"linear\") +\nbeta_ndvi(ndvi, model=\"linear\") +\nbeta_urban(urban, model=\"linear\") +\ntime(time, model=\"rw1\") +\nfield(geometry, model = spde)\n\n\nLikelihood:\n\n\nCode\nlik_st &lt;- like(\nfamily=\"binomial\",\ndata = st_binom,\nformula = n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban +\ntime + field,\nNtrials = n_tested\n)\n\n\nFit:\n\n\nCode\nfit_st_binom &lt;- bru(components_st, lik_st)\nsummary(fit_st_binom)\n\n\ninlabru version: 2.13.0.9024 \nINLA version: 25.12.02 \nLatent components:\nIntercept: main = linear(1)\nbeta_elev: main = linear(elevation)\nbeta_ndvi: main = linear(ndvi)\nbeta_urban: main = linear(urban)\ntime: main = rw1(time)\nfield: main = spde(geometry)\nObservation models:\n  Model tag: &lt;No tag&gt;\n    Family: 'binomial'\n    Data class: 'sf', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban + time + field\n    Additive/Linear/Rowwise: TRUE/TRUE/TRUE\n    Used components: effect[Intercept, beta_elev, beta_ndvi, beta_urban, time, field], latent[] \nTime used:\n    Pre = 0.697, Running = 0.992, Post = 0.124, Total = 1.81 \nFixed effects:\n             mean    sd 0.025quant 0.5quant 0.975quant   mode kld\nIntercept  -0.261 0.332     -0.909   -0.263      0.399 -0.263   0\nbeta_elev  -0.002 0.001     -0.003   -0.002     -0.001 -0.002   0\nbeta_ndvi   1.775 0.591      0.590    1.781      2.926  1.781   0\nbeta_urban  0.525 0.028      0.470    0.525      0.580  0.525   0\n\nRandom effects:\n  Name    Model\n    time RW1 model\n   field SPDE2 model\n\nModel hyperparameters:\n                       mean       sd 0.025quant 0.5quant 0.975quant     mode\nPrecision for time 4.49e+00 2.65e+00   1.25e+00 3.88e+00   1.13e+01 2.85e+00\nRange for field    1.73e+05 2.65e+04   1.28e+05 1.71e+05   2.32e+05 1.65e+05\nStdev for field    6.52e-01 5.20e-02   5.57e-01 6.50e-01   7.61e-01 6.44e-01\n\nMarginal log-Likelihood:  -3963.37 \n is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')\n\n\n\n\n\n\n\nCode\npred_grid$time &lt;- 7\n\npred_st &lt;- predict(\nfit_st_binom,\nnewdata = pred_grid,\nformula = ~ plogis(Intercept + beta_elev + beta_ndvi + beta_urban +\ntime + field),\nn.samples = 500\n)\n\n\nMap for 2020:\n\n\nCode\npred_st_r &lt;- st_rasterize(pred_st[\"mean\"], dx=10000, dy=10000)\n\nggplot() +\n  geom_stars(data = pred_st_r, na.rm = TRUE) +\n  scale_fill_viridis_c(name=\"Prev time 7\", na.value = NA) +\n  geom_sf(data=nga_admin1, fill=NA) +\n  theme_minimal() +\n  theme(\n    panel.background = element_rect(fill = \"white\", colour = NA),\n    plot.background  = element_rect(fill = \"white\", colour = NA),\n    panel.grid       = element_blank()\n  )"
  },
  {
    "objectID": "day1.html#load-data",
    "href": "day1.html#load-data",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "These data were generated during preprocessing and saved to data/\n\n\nCode\nlibrary(tidyverse)\nlibrary(INLA)\nlibrary(inlabru)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(stars)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n\nnga_admin1 &lt;- ne_states(\"Nigeria\", returnclass = \"sf\") %&gt;%\nst_transform(32632)\n\nspatial_binom &lt;- read_csv(\"data/spatial_binomial_data.csv\")\nspatial_pois  &lt;- read_csv(\"data/spatial_poisson_data.csv\")"
  },
  {
    "objectID": "day1.html#convert-to-sf-for-mapping",
    "href": "day1.html#convert-to-sf-for-mapping",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "We need an sf layer to overlay boundaries, plot points, and feed coordinates into SPDE meshes.\n\n\nCode\nspatial_binom_sf &lt;- spatial_binom %&gt;%\n  st_as_sf(coords = c(\"utm_x\", \"utm_y\"), crs = 32632)\nspatial_pois_sf &lt;- spatial_pois %&gt;%\n  st_as_sf(coords = c(\"utm_x\", \"utm_y\"), crs = 32632)"
  },
  {
    "objectID": "day1.html#visualise-sampling-locations",
    "href": "day1.html#visualise-sampling-locations",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "This helps confirm:\n\nUTM conversion is correct\nPoints sit inside Nigeria\nPrevalence has spatial structure\n\n\n\nCode\nggplot() +\ngeom_sf(data = spatial_binom_sf, aes(colour = prevalence_true)) +\ngeom_sf(data = nga_admin1, fill = NA) +\nscale_colour_viridis_c(name=\"Prevalence\") +\ntheme_minimal()"
  },
  {
    "objectID": "day1.html#build-the-spde-mesh",
    "href": "day1.html#build-the-spde-mesh",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "The mesh defines the geometry on which the latent spatial field is approximated.\n\n\nCode\ncoords &lt;- st_coordinates(spatial_binom_sf)\n\nmesh &lt;- inla.mesh.2d(\nloc = coords,\nmax.edge = c(100000, 200000), # inner and outer triangle sizes\ncutoff = 20000,  # merge points closer than 20km\noffset = c(50000, 200000)  # extend mesh beyond convex hull\n)\n\nplot(mesh)\npoints(coords, col=\"red\", pch=16)\n\n\n\n\n\n\n\n\n\nA finer mesh → more accurate, more expensive.\nA coarser mesh → faster, less precise.\nWe balance cost vs smoothness."
  },
  {
    "objectID": "day1.html#spde-model-pc-priors",
    "href": "day1.html#spde-model-pc-priors",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "Penalised complexity (PC) priors make spatial models robust and interpretable.\n\n\nCode\nspde &lt;- inla.spde2.pcmatern(\nmesh = mesh,\nprior.range = c(300000, 0.5),\nprior.sigma = c(1.0, 0.01)\n)"
  },
  {
    "objectID": "day1.html#spatial-binomial-model",
    "href": "day1.html#spatial-binomial-model",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "The model is:\n\\[logit(pi​)=\\beta_0​+\\beta_1​ elevation_i​+ \\beta_2​ndvi_i​+ \\beta_3 ​urban_i​+ S(s_i​)\\]\nWhere \\(S(\\mathbf{s})\\) is a spatial Gaussian field.\n\n\nCode\ncomponents_binom &lt;- ~\nIntercept(1, model=\"linear\") +\nbeta_elev(elevation, model=\"linear\") +\nbeta_ndvi(ndvi, model=\"linear\") +\nbeta_urban(urban, model=\"linear\") +\nfield(geometry, model = spde)\n\nlik_binom &lt;- like(\nfamily=\"binomial\",\ndata=spatial_binom_sf,\nformula = n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban + field,\nNtrials = n_tested\n)\n\n#| cache: true\nfit_binom &lt;- bru(components_binom, lik_binom)\nsummary(fit_binom)\n\n\ninlabru version: 2.13.0.9024 \nINLA version: 25.12.02 \nLatent components:\nIntercept: main = linear(1)\nbeta_elev: main = linear(elevation)\nbeta_ndvi: main = linear(ndvi)\nbeta_urban: main = linear(urban)\nfield: main = spde(geometry)\nObservation models:\n  Model tag: &lt;No tag&gt;\n    Family: 'binomial'\n    Data class: 'sf', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban + field\n    Additive/Linear/Rowwise: TRUE/TRUE/TRUE\n    Used components: effect[Intercept, beta_elev, beta_ndvi, beta_urban, field], latent[] \nTime used:\n    Pre = 0.797, Running = 1.19, Post = 0.195, Total = 2.19 \nFixed effects:\n             mean    sd 0.025quant 0.5quant 0.975quant   mode kld\nIntercept  -3.464 0.779     -5.034   -3.452     -1.965 -3.453   0\nbeta_elev  -0.003 0.001     -0.006   -0.003      0.000 -0.003   0\nbeta_ndvi   5.350 1.305      2.796    5.340      7.962  5.341   0\nbeta_urban  0.456 0.059      0.341    0.456      0.572  0.456   0\n\nRandom effects:\n  Name    Model\n    field SPDE2 model\n\nModel hyperparameters:\n                    mean       sd 0.025quant 0.5quant 0.975quant     mode\nRange for field 2.79e+05 4.70e+04   2.01e+05 2.74e+05   3.86e+05 2.62e+05\nStdev for field 1.12e+00 1.34e-01   8.90e-01 1.11e+00   1.42e+00 1.08e+00\n\nMarginal log-Likelihood:  -935.76 \n is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')"
  },
  {
    "objectID": "day1.html#spatial-poisson-model",
    "href": "day1.html#spatial-poisson-model",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "Often used for malaria case counts or incidence.\nModel: \\[\\log(\\lambda_i)= \\beta_0 + \\beta_1 X_i + S(s_i)\\]\n\n\nCode\ncomponents_pois &lt;- ~\nIntercept(1, model=\"linear\") +\nbeta_elev(elevation, model=\"linear\") +\nbeta_ndvi(ndvi, model=\"linear\") +\nbeta_urban(urban, model=\"linear\") +\nfield(geometry, model = spde)\n\nlik_pois &lt;- like(\nfamily=\"poisson\",\ndata=spatial_pois_sf,\nformula = cases ~ Intercept + beta_elev + beta_ndvi + beta_urban + field\n)\n\n#| cache: true\nfit_pois &lt;- bru(components_pois, lik_pois)\nsummary(fit_pois)\n\n\ninlabru version: 2.13.0.9024 \nINLA version: 25.12.02 \nLatent components:\nIntercept: main = linear(1)\nbeta_elev: main = linear(elevation)\nbeta_ndvi: main = linear(ndvi)\nbeta_urban: main = linear(urban)\nfield: main = spde(geometry)\nObservation models:\n  Model tag: &lt;No tag&gt;\n    Family: 'poisson'\n    Data class: 'sf', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: cases ~ Intercept + beta_elev + beta_ndvi + beta_urban + field\n    Additive/Linear/Rowwise: TRUE/TRUE/TRUE\n    Used components: effect[Intercept, beta_elev, beta_ndvi, beta_urban, field], latent[] \nTime used:\n    Pre = 0.752, Running = 0.933, Post = 0.246, Total = 1.93 \nFixed effects:\n             mean    sd 0.025quant 0.5quant 0.975quant   mode kld\nIntercept   0.530 0.617     -0.661    0.523      1.766  0.523   0\nbeta_elev  -0.001 0.002     -0.004   -0.001      0.002 -0.001   0\nbeta_ndvi   1.432 0.731     -0.063    1.449      2.829  1.448   0\nbeta_urban  0.747 0.082      0.587    0.747      0.909  0.747   0\n\nRandom effects:\n  Name    Model\n    field SPDE2 model\n\nModel hyperparameters:\n                    mean      sd 0.025quant 0.5quant 0.975quant     mode\nRange for field 1.34e+05 3.7e+04   7.56e+04 1.29e+05   2.20e+05 1.19e+05\nStdev for field 8.23e-01 9.4e-02   6.54e-01 8.18e-01   1.02e+00 8.07e-01\n\nMarginal log-Likelihood:  -631.40 \n is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')"
  },
  {
    "objectID": "day1.html#predictive-surfaces-binomial-example",
    "href": "day1.html#predictive-surfaces-binomial-example",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "Code\npred_grid &lt;- read_csv(\"data/prediction_grid_utm.csv\") %&gt;%\nst_as_sf(coords=c(\"utm_x\",\"utm_y\"), crs=32632)\n\npred_binom &lt;- predict(\nfit_binom,\nnewdata = pred_grid,\nformula = ~ plogis(Intercept + beta_elev + beta_ndvi + beta_urban + field),\nn.samples = 1000\n)\n\n\nRasterise:\n\n\nCode\npred_binom_r &lt;- st_rasterize(pred_binom[\"mean\"], dx=10000, dy=10000)\npred_binom_r &lt;- pred_binom_r[st_union(nga_admin1)]\n\n\nPlot:\n\n\nCode\nggplot() +\n  geom_stars(data=pred_binom_r, na.rm = TRUE) +\n  scale_fill_viridis_c(name=\"Prev\", na.value = NA) +\n  geom_sf(data=nga_admin1, fill=NA) +\n  theme_minimal() +\n  theme(\n    panel.background = element_rect(fill = \"white\", colour = NA),\n    plot.background  = element_rect(fill = \"white\", colour = NA),\n    panel.grid       = element_blank()\n  )"
  },
  {
    "objectID": "day1.html#exceedance-probability-binomial",
    "href": "day1.html#exceedance-probability-binomial",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "Goal:\n\\[P(prevalence&gt;0.5∣data)\\]\n\n\nCode\nexc_samples &lt;- generate(\nfit_binom,\nnewdata = pred_grid,\nformula = ~ plogis(Intercept + beta_elev + beta_ndvi + beta_urban + field),\nn.samples = 1000\n)\n\npred_binom$exc_prob &lt;- rowMeans(exc_samples &gt; 0.5)\n\n\nMap:\n\n\nCode\nexc_r &lt;- st_rasterize(pred_binom[\"exc_prob\"], dx=10000, dy=10000)\nexc_r &lt;- exc_r[st_union(nga_admin1)]\n\nggplot() +\n  geom_stars(data=exc_r, na.rm = TRUE) +\n  scale_fill_viridis_c(name=\"P(prev&gt;0.5)\", limits=c(0,1), na.value = NA) +\n  geom_sf(data=nga_admin1, fill=NA) +\n  theme_minimal() + \n  theme(\n    panel.background = element_rect(fill = \"white\", colour = NA),\n    plot.background  = element_rect(fill = \"white\", colour = NA),\n    panel.grid       = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n============================================================\nPART B — Spatio-Temporal Modelling ============================================================\nWe now extend:\n\\[S(s)⟶S(s,t)\\]\nA common structure:\n\nSpatial effect: SPDE\nTemporal effect: random walk (RW1 or RW2)\nInteraction: separable \\(S(s,t)=S_s(s)+S_t(t)\\)\n\n\n\nCode\nst_binom &lt;- read_csv(\"data/spatiotemporal_binomial_data.csv\") %&gt;%\n  st_as_sf(coords=c(\"utm_x\",\"utm_y\"), crs=32632)\n\nhead(st_binom)\n\n\nSimple feature collection with 6 features and 10 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 336995.7 ymin: 1047442 xmax: 336995.7 ymax: 1047442\nProjected CRS: WGS 84 / UTM zone 32N\n# A tibble: 6 × 11\n   site  time     S gamma_t elevation  ndvi urban n_tested n_pos prevalence_true\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;\n1     1     1 0.266   2.12       228. 0.305     0       63    51           0.774\n2     1     2 0.266   1.50       228. 0.305     0       65    43           0.649\n3     1     3 0.266   0.381      228. 0.305     0      119    52           0.376\n4     1     4 0.266   0.286      228. 0.305     0      191    72           0.354\n5     1     5 0.266   0.168      228. 0.305     0      180    50           0.327\n6     1     6 0.266   0.207      228. 0.305     0      155    52           0.336\n# ℹ 1 more variable: geometry &lt;POINT [m]&gt;\n\n\nShould contain:\n\ntime\nn_tested, n_pos\ncovariates\nUTM coordinates"
  },
  {
    "objectID": "day1.html#spatio-temporal-components",
    "href": "day1.html#spatio-temporal-components",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "Use: - RW1 for time - SPDE for space - Additive interaction\n\n\nCode\ncomponents_st &lt;- ~\nIntercept(1, model=\"linear\") +\nbeta_elev(elevation, model=\"linear\") +\nbeta_ndvi(ndvi, model=\"linear\") +\nbeta_urban(urban, model=\"linear\") +\ntime(time, model=\"rw1\") +\nfield(geometry, model = spde)\n\n\nLikelihood:\n\n\nCode\nlik_st &lt;- like(\nfamily=\"binomial\",\ndata = st_binom,\nformula = n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban +\ntime + field,\nNtrials = n_tested\n)\n\n\nFit:\n\n\nCode\nfit_st_binom &lt;- bru(components_st, lik_st)\nsummary(fit_st_binom)\n\n\ninlabru version: 2.13.0.9024 \nINLA version: 25.12.02 \nLatent components:\nIntercept: main = linear(1)\nbeta_elev: main = linear(elevation)\nbeta_ndvi: main = linear(ndvi)\nbeta_urban: main = linear(urban)\ntime: main = rw1(time)\nfield: main = spde(geometry)\nObservation models:\n  Model tag: &lt;No tag&gt;\n    Family: 'binomial'\n    Data class: 'sf', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban + time + field\n    Additive/Linear/Rowwise: TRUE/TRUE/TRUE\n    Used components: effect[Intercept, beta_elev, beta_ndvi, beta_urban, time, field], latent[] \nTime used:\n    Pre = 0.697, Running = 0.992, Post = 0.124, Total = 1.81 \nFixed effects:\n             mean    sd 0.025quant 0.5quant 0.975quant   mode kld\nIntercept  -0.261 0.332     -0.909   -0.263      0.399 -0.263   0\nbeta_elev  -0.002 0.001     -0.003   -0.002     -0.001 -0.002   0\nbeta_ndvi   1.775 0.591      0.590    1.781      2.926  1.781   0\nbeta_urban  0.525 0.028      0.470    0.525      0.580  0.525   0\n\nRandom effects:\n  Name    Model\n    time RW1 model\n   field SPDE2 model\n\nModel hyperparameters:\n                       mean       sd 0.025quant 0.5quant 0.975quant     mode\nPrecision for time 4.49e+00 2.65e+00   1.25e+00 3.88e+00   1.13e+01 2.85e+00\nRange for field    1.73e+05 2.65e+04   1.28e+05 1.71e+05   2.32e+05 1.65e+05\nStdev for field    6.52e-01 5.20e-02   5.57e-01 6.50e-01   7.61e-01 6.44e-01\n\nMarginal log-Likelihood:  -3963.37 \n is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')"
  },
  {
    "objectID": "day1.html#predict-spatio-temporal-prevalence-example-year-2020",
    "href": "day1.html#predict-spatio-temporal-prevalence-example-year-2020",
    "title": "Day 1 – Spatial & Spatio-Temporal Modelling",
    "section": "",
    "text": "Code\npred_grid$time &lt;- 7\n\npred_st &lt;- predict(\nfit_st_binom,\nnewdata = pred_grid,\nformula = ~ plogis(Intercept + beta_elev + beta_ndvi + beta_urban +\ntime + field),\nn.samples = 500\n)\n\n\nMap for 2020:\n\n\nCode\npred_st_r &lt;- st_rasterize(pred_st[\"mean\"], dx=10000, dy=10000)\n\nggplot() +\n  geom_stars(data = pred_st_r, na.rm = TRUE) +\n  scale_fill_viridis_c(name=\"Prev time 7\", na.value = NA) +\n  geom_sf(data=nga_admin1, fill=NA) +\n  theme_minimal() +\n  theme(\n    panel.background = element_rect(fill = \"white\", colour = NA),\n    plot.background  = element_rect(fill = \"white\", colour = NA),\n    panel.grid       = element_blank()\n  )"
  },
  {
    "objectID": "slides/day2_slides.html#todays-focus",
    "href": "slides/day2_slides.html#todays-focus",
    "title": "Day 2 – Joint Modelling + Non-stationarity",
    "section": "Today’s Focus",
    "text": "Today’s Focus\n\nJoint models\nShared vs group-specific fields\nNon-stationary spatial processes"
  },
  {
    "objectID": "slides/day2_slides.html#load-datasets",
    "href": "slides/day2_slides.html#load-datasets",
    "title": "Day 2 – Joint Modelling + Non-stationarity",
    "section": "Load Datasets",
    "text": "Load Datasets\n\nlibrary(readr)\n\njoint_malaria &lt;- read_csv(\"../data/joint_malaria_processes.csv\")\nnonstat_malaria &lt;- read_csv(\"../data/nonstationary_malaria_data.csv\")\nhead(joint_malaria)\n\n# A tibble: 6 × 12\n     id group    utm_x  utm_y n_tested n_pos prevalence_true S_shared S_specific\n  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n1     1 child… 249196. 7.37e5      148    48           0.281   0.297      -0.409\n2     2 child… 703934. 9.57e5      107    35           0.337  -0.0736      0.415\n3     3 child… -90558. 9.32e5      139    66           0.416   0.680      -0.145\n4     4 child… 252087. 1.11e6      138    55           0.369  -0.147       0.277\n5     5 child… 685078. 1.34e6      183    47           0.219  -0.192      -0.281\n6     6 child… 422901. 5.12e5      131    63           0.501   0.589       0.166\n# ℹ 3 more variables: elevation &lt;dbl&gt;, ndvi &lt;dbl&gt;, urban &lt;dbl&gt;"
  },
  {
    "objectID": "day3.html",
    "href": "day3.html",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "",
    "text": "Today we combine:\n\nMachine learning models (e.g., Random Forest, XGBoost)\nSpatial residual modelling via SPDE + inlabru\nHybrid prediction pipelines for malaria prevalence\n\nThe goal:\nUse ML to model complex covariate effects, and INLA/SPDE to model spatial dependence in the residuals."
  },
  {
    "objectID": "day3.html#overview",
    "href": "day3.html#overview",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "",
    "text": "Today we combine:\n\nMachine learning models (e.g., Random Forest, XGBoost)\nSpatial residual modelling via SPDE + inlabru\nHybrid prediction pipelines for malaria prevalence\n\nThe goal:\nUse ML to model complex covariate effects, and INLA/SPDE to model spatial dependence in the residuals."
  },
  {
    "objectID": "day3.html#load-day-3-dataset",
    "href": "day3.html#load-day-3-dataset",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "Load Day 3 dataset",
    "text": "Load Day 3 dataset\n\n\nCode\nlibrary(tidyverse)\n\nhybrid_ml_geo &lt;- read_csv(\"data/hybrid_ml_geostatistical_data.csv\")\n\nhead(hybrid_ml_geo)\n\n\n# A tibble: 6 × 11\n     id   utm_x    utm_y n_tested n_pos prevalence_true ml_signal_true\n  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;\n1     1 279090.  838870.       63     0        0.00167           -5.04\n2     2  57751.  672968.      125     0        0.000452          -6.60\n3     3 160759. 1365476.      139     0        0.00694           -3.80\n4     4 949111. 1230481.      126     0        0.000334          -7.10\n5     5 434005.  682490.       97     0        0.00205           -5.51\n6     6 -91406.  925776.      122     3        0.00767           -3.16\n# ℹ 4 more variables: S_residual_true &lt;dbl&gt;, elevation &lt;dbl&gt;, ndvi &lt;dbl&gt;,\n#   urban &lt;dbl&gt;\n\n\nVisualise ML signal + spatial residuals\n\n\nCode\nlibrary(ggplot2)\n\nggplot(hybrid_ml_geo, aes(utm_x, utm_y, colour = ml_signal_true)) +\ngeom_point() +\ncoord_equal() +\ntheme_minimal()"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Geostatistical Modelling with inlabru",
    "section": "",
    "text": "This workshop is funded by the London Mathematical Society (LMS) Scheme 5.\n\nWelcome to the Geostatistical Modelling with inlabru workshop.\nThis 3-day workshop covers:\n\nSpatial and spatio-temporal analysis (different likelihoods)\nJoint modelling of multiple malaria processes\nNon-stationary spatial processes\nHybrid machine learning + geostatistical models"
  },
  {
    "objectID": "day2.html",
    "href": "day2.html",
    "title": "Day 2 – Joint modelling and Non-stationary processes",
    "section": "",
    "text": "Today we will cover two key advanced topics in spatial modelling:\n\nJoint modelling of multiple malaria processes\n\nShared spatial fields\n\nProcess-specific fields\n\nMultiple outcomes (e.g., children vs pregnant women)\n\nNon-stationary spatial processes\n\nRegion-varying smoothness\n\nCovariate-driven nonstationarity\n\nCombining multiple spatial SPDEs"
  },
  {
    "objectID": "day2.html#overview",
    "href": "day2.html#overview",
    "title": "Day 2 – Joint modelling and Non-stationary processes",
    "section": "",
    "text": "Today we will cover two key advanced topics in spatial modelling:\n\nJoint modelling of multiple malaria processes\n\nShared spatial fields\n\nProcess-specific fields\n\nMultiple outcomes (e.g., children vs pregnant women)\n\nNon-stationary spatial processes\n\nRegion-varying smoothness\n\nCovariate-driven nonstationarity\n\nCombining multiple spatial SPDEs"
  },
  {
    "objectID": "day2.html#load-day-2-datasets",
    "href": "day2.html#load-day-2-datasets",
    "title": "Day 2 – Joint modelling and Non-stationary processes",
    "section": "Load Day 2 datasets",
    "text": "Load Day 2 datasets\n\n\nCode\nlibrary(tidyverse)\n\njoint_malaria &lt;- read_csv(\"data/joint_malaria_processes.csv\")\nnonstat_malaria &lt;- read_csv(\"data/nonstationary_malaria_data.csv\")\n\nhead(joint_malaria)\n\n\n# A tibble: 6 × 12\n     id group    utm_x  utm_y n_tested n_pos prevalence_true S_shared S_specific\n  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n1     1 child… 249196. 7.37e5      148    48           0.281   0.297      -0.409\n2     2 child… 703934. 9.57e5      107    35           0.337  -0.0736      0.415\n3     3 child… -90558. 9.32e5      139    66           0.416   0.680      -0.145\n4     4 child… 252087. 1.11e6      138    55           0.369  -0.147       0.277\n5     5 child… 685078. 1.34e6      183    47           0.219  -0.192      -0.281\n6     6 child… 422901. 5.12e5      131    63           0.501   0.589       0.166\n# ℹ 3 more variables: elevation &lt;dbl&gt;, ndvi &lt;dbl&gt;, urban &lt;dbl&gt;\n\n\nQuick visualisation\n\n\nCode\nlibrary(ggplot2)\n\nggplot(joint_malaria, aes(utm_x, utm_y, colour = group)) +\ngeom_point() +\ncoord_equal() +\ntheme_minimal()\n\n\n\n\n\n\n\n\n\nQuick visualisation (non-stationary dataset)\n\n\nCode\nggplot(nonstat_malaria, aes(utm_x, utm_y, colour = prevalence_true)) +\ngeom_point() +\ncoord_equal() +\nscale_colour_viridis_c() +\ntheme_minimal()"
  },
  {
    "objectID": "slides/day1_slides.html#about-me",
    "href": "slides/day1_slides.html#about-me",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "About me",
    "text": "About me\n\nCompleted a Bachelor’s degree in Statistics at FUTA\nMaster’s in Mathamatical Sciences at AIMS-Tanzania\nPhD in Statistics and Epidemiology at University of Lancaster\nPostdoc at University of Manchester\nLecturer in Statistics at the University of Manchester"
  },
  {
    "objectID": "slides/day1_slides.html#overview-of-the-3-days",
    "href": "slides/day1_slides.html#overview-of-the-3-days",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Overview of the 3 days",
    "text": "Overview of the 3 days\n\nSpatial and spatio-temporal analysis (different likelihoods)\nJoint modelling of multiple malaria processes\nNon-stationary spatial processes\nHybrid machine learning + geostatistical models"
  },
  {
    "objectID": "slides/day1_slides.html#linear-regression",
    "href": "slides/day1_slides.html#linear-regression",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Linear Regression",
    "text": "Linear Regression\n\nGoal: Model a continuous response variable as a linear function of predictors.\nModel \\(Y = X \\beta + \\epsilon\\), where \\(\\epsilon \\sim N(0, \\sigma^2)\\)\nKey Assumption\n\nLinearity\nIndependence\nHomoscedasticity (constant variance)\nNormality of errors"
  },
  {
    "objectID": "slides/day1_slides.html#generalized-linear-models-glms",
    "href": "slides/day1_slides.html#generalized-linear-models-glms",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Generalized Linear Models (GLMs)",
    "text": "Generalized Linear Models (GLMs)\n\nExtension of linear models to handle non-normal response distributions.\nThree components:\n\nRandom component: Distribution from the exponential family (e.g., Binomial, Poisson).\nSystematic component: Linear predictor \\(\\eta = X\\beta\\).\nLink function: Relates $\\mathbb{E}(Y) ~~~ \\text{to} ~~~ \\eta $.\n\nExamples:\n\nLogistic regression for binary outcomes – logit link function\nPoisson regression for count data – log link function"
  },
  {
    "objectID": "slides/day1_slides.html#why-spatial-statistics",
    "href": "slides/day1_slides.html#why-spatial-statistics",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Why Spatial Statistics?",
    "text": "Why Spatial Statistics?\n\nSpatial Dependence:\nObservations collected at nearby locations are often more similar than those farther apart.\nIgnoring Spatial Structure:\n\nLeads to biased parameter estimates.\nUnderestimates uncertainty.\nMisses important spatial patterns.\n\nApplications:\n\nDisease mapping\n\nEnvironmental monitoring\n\nAgricultural field trials\n\nGoal:\nAccount for spatial correlation to improve prediction and inference."
  },
  {
    "objectID": "slides/day1_slides.html#spatial-statistics",
    "href": "slides/day1_slides.html#spatial-statistics",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Spatial Statistics",
    "text": "Spatial Statistics\n\n\n\n\n\nCressie 1991\n\n\n\n\n\n\nGelfand 2010"
  },
  {
    "objectID": "slides/day1_slides.html#classification-of-spatial-statistics",
    "href": "slides/day1_slides.html#classification-of-spatial-statistics",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Classification of spatial statistics",
    "text": "Classification of spatial statistics\nCressie’s book classifies spatial statistics according to data format:\n\nGeostatistical data\n\nLattice data\n\nPoint patterns\n\nGelfand’s book classifies spatial statistics according to spatial variation:\n\nDiscrete spatial variation\n\nContinuous spatial variation"
  },
  {
    "objectID": "slides/day1_slides.html#geostatistical-data-river-blindness-in-cameroon",
    "href": "slides/day1_slides.html#geostatistical-data-river-blindness-in-cameroon",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Geostatistical data: River blindness in Cameroon",
    "text": "Geostatistical data: River blindness in Cameroon\n\nGeostatistical data: River blindness in Cameroon"
  },
  {
    "objectID": "slides/day1_slides.html#lattice-data-copd-emergency-admission",
    "href": "slides/day1_slides.html#lattice-data-copd-emergency-admission",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Lattice Data: COPD emergency admission",
    "text": "Lattice Data: COPD emergency admission\n\nLattice data: COPD emergency admission"
  },
  {
    "objectID": "slides/day1_slides.html#point-pattern-primary-biliary-cirrhosis-data",
    "href": "slides/day1_slides.html#point-pattern-primary-biliary-cirrhosis-data",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Point pattern: Primary biliary cirrhosis data",
    "text": "Point pattern: Primary biliary cirrhosis data\n\nPoint pattern: Primary biliary cirrhosis data"
  },
  {
    "objectID": "slides/day1_slides.html#modelling-geostatistical-data-model-based-geostatistics",
    "href": "slides/day1_slides.html#modelling-geostatistical-data-model-based-geostatistics",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Modelling Geostatistical Data – Model-based Geostatistics",
    "text": "Modelling Geostatistical Data – Model-based Geostatistics\n\nThe term Model-based Geostatistics (MBG) was coined by Peter Diggle in 1998 (Diggle, Tawn, and Moyeed 1998; Diggle and Giorgi 2019).\nMBG applies general principles of statistical modelling and inference to the analysis of geostatistical data.\nIt emphasises the use of likelihood-based inference.\nand the use of a latent spatial process (Gaussian or stochastic process)"
  },
  {
    "objectID": "slides/day1_slides.html#references",
    "href": "slides/day1_slides.html#references",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "References",
    "text": "References\n\n\n\n\nDiggle, Peter, and Emanuele Giorgi. 2019. Model-Based Geostatistics. CRC Press.\n\n\nDiggle, Peter, Jonathan Tawn, and Rana Moyeed. 1998. “Model-Based Geostatistics.” Journal of the Royal Statistical Society: Series C 47: 299–350."
  },
  {
    "objectID": "slides/day3_slides.html#todays-goal",
    "href": "slides/day3_slides.html#todays-goal",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "Today’s Goal",
    "text": "Today’s Goal\nIntegrate:\n\nMachine learning\n\nSpatial geostatistics\n\nHybrid prediction modelling"
  },
  {
    "objectID": "slides/day3_slides.html#load-data",
    "href": "slides/day3_slides.html#load-data",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "Load Data",
    "text": "Load Data\n\nlibrary(readr)\nhybrid_ml_geo &lt;- read_csv(\"../data/hybrid_ml_geostatistical_data.csv\")\nhead(hybrid_ml_geo)\n\n# A tibble: 6 × 11\n     id   utm_x    utm_y n_tested n_pos prevalence_true ml_signal_true\n  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;\n1     1 279090.  838870.       63     0        0.00167           -5.04\n2     2  57751.  672968.      125     0        0.000452          -6.60\n3     3 160759. 1365476.      139     0        0.00694           -3.80\n4     4 949111. 1230481.      126     0        0.000334          -7.10\n5     5 434005.  682490.       97     0        0.00205           -5.51\n6     6 -91406.  925776.      122     3        0.00767           -3.16\n# ℹ 4 more variables: S_residual_true &lt;dbl&gt;, elevation &lt;dbl&gt;, ndvi &lt;dbl&gt;,\n#   urban &lt;dbl&gt;"
  }
]