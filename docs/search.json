[
  {
    "objectID": "slides/day3_slides.html#todays-goal",
    "href": "slides/day3_slides.html#todays-goal",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "Today’s Goal",
    "text": "Today’s Goal\nIntegrate:\n\nMachine learning\n\nSpatial geostatistics\n\nHybrid prediction modelling"
  },
  {
    "objectID": "slides/day3_slides.html#load-data",
    "href": "slides/day3_slides.html#load-data",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "Load Data",
    "text": "Load Data\n\nlibrary(readr)\nhybrid_ml_geo &lt;- read_csv(\"../data/hybrid_ml_geostatistical_data.csv\")\nhead(hybrid_ml_geo)\n\n# A tibble: 6 × 11\n     id    utm_x    utm_y n_tested n_pos prevalence_true ml_signal_true\n  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;\n1     1  387215. 1485399.       59     0     0.000334            -7.06 \n2     2 1046370.  758144.      180     8     0.0496              -1.66 \n3     3  681525. 1102741.      164    22     0.167               -0.980\n4     4  713355. 1127489.       62     0     0.00476             -4.17 \n5     5  276748. 1384709.       84     0     0.00000423         -11.6  \n6     6 -112576. 1315376.       60     0     0.000000669        -12.5  \n# ℹ 4 more variables: S_residual_true &lt;dbl&gt;, elevation &lt;dbl&gt;, ndvi &lt;dbl&gt;,\n#   urban &lt;dbl&gt;"
  },
  {
    "objectID": "slides/day1_slides.html#welcome-to-day-1",
    "href": "slides/day1_slides.html#welcome-to-day-1",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Welcome to Day 1",
    "text": "Welcome to Day 1\n\nSpatial geostatistical modelling\n\nSpatio-temporal extensions\n\nMalaria data simulated for Nigeria\n\nAll modelling uses UTM coordinates"
  },
  {
    "objectID": "slides/day1_slides.html#load-the-data",
    "href": "slides/day1_slides.html#load-the-data",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Load the Data",
    "text": "Load the Data\n\nlibrary(readr) \nspatial_binom &lt;- read_csv(\"../data/spatial_binomial_data.csv\")\nhead(spatial_binom)\n\n# A tibble: 6 × 10\n     id   utm_x    utm_y n_tested n_pos prevalence_true       S elevation  ndvi\n  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;\n1     1 385648. 1454675.      182    72           0.351  0.0139    363.   0.934\n2     2  58859. 1077815.       64    30           0.632  0.680     165.   0.827\n3     3 437997.  476112.       67    17           0.287  0.489     359.   0.158\n4     4 380293. 1341662.      188    77           0.419 -0.101       8.90 0.981\n5     5 319034.  570466.       97    22           0.272 -0.244     484.   0.941\n6     6 980518.  974256.       88    48           0.427  0.809     474.   0.173\n# ℹ 1 more variable: urban &lt;dbl&gt;"
  },
  {
    "objectID": "day1_spatial.html#overview",
    "href": "day1_spatial.html#overview",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Overview",
    "text": "Overview\nOn Day 1 we will:\n\nLoad the spatial malaria datasets\nWork with UTM coordinates\nBuild SPDE meshes\nFit spatial and spatio-temporal models with inlabru"
  },
  {
    "objectID": "day1_spatial.html#load-data-once-csvs-are-in-data",
    "href": "day1_spatial.html#load-data-once-csvs-are-in-data",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Load data (once CSVs are in data/)",
    "text": "Load data (once CSVs are in data/)\n\n\nCode\nlibrary(tidyverse)\nlibrary(INLA)\nlibrary(inlabru)\nlibrary(ggplot2)\nlibrary(sf)\n\nspatial_binom &lt;- read_csv(\"data/spatial_binomial_data.csv\")\nhead(spatial_binom)\n\n\n# A tibble: 6 × 10\n     id   utm_x    utm_y n_tested n_pos prevalence_true       S elevation  ndvi\n  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;\n1     1 385648. 1454675.      182    72           0.351  0.0139    363.   0.934\n2     2  58859. 1077815.       64    30           0.632  0.680     165.   0.827\n3     3 437997.  476112.       67    17           0.287  0.489     359.   0.158\n4     4 380293. 1341662.      188    77           0.419 -0.101       8.90 0.981\n5     5 319034.  570466.       97    22           0.272 -0.244     484.   0.941\n6     6 980518.  974256.       88    48           0.427  0.809     474.   0.173\n# ℹ 1 more variable: urban &lt;dbl&gt;"
  },
  {
    "objectID": "day1_spatial.html#quick-plot-of-locations-utm",
    "href": "day1_spatial.html#quick-plot-of-locations-utm",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Quick plot of locations (UTM)",
    "text": "Quick plot of locations (UTM)\n\n\nCode\nggplot(spatial_binom, aes(utm_x, utm_y, colour = n_pos / n_tested)) +\ngeom_point() +\ncoord_equal() +\nscale_colour_viridis_c(name = \"Prevalence\") +\ntheme_minimal()"
  },
  {
    "objectID": "day1_spatial.html#build-the-spde-mesh-on-utm-coordinates",
    "href": "day1_spatial.html#build-the-spde-mesh-on-utm-coordinates",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Build the SPDE mesh on UTM coordinates",
    "text": "Build the SPDE mesh on UTM coordinates\n\n\nCode\n# Coordinates matrix for mesh\ncoords &lt;- cbind(spatial_binom$utm_x, spatial_binom$utm_y)\n\n# Create a 2D mesh (tune max.edge / cutoff as needed)\nmesh &lt;- inla.mesh.2d(\n  loc = coords,\n  max.edge = c(100000, 300000),   # in metres (since UTM)\n  cutoff  = 20000,                # min distance between points\n  offset  = c(50000, 200000)      # inner/outer extension of mesh\n)\n\nplot(mesh)\npoints(coords, col = \"red\", pch = 16, cex = 0.6)"
  },
  {
    "objectID": "day1_spatial.html#convert-data-to-sf-object",
    "href": "day1_spatial.html#convert-data-to-sf-object",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Convert data to sf object",
    "text": "Convert data to sf object\n\n\nCode\nspatial_binom_sf &lt;- spatial_binom %&gt;% st_as_sf(coords = c(\"utm_x\", \"utm_y\"), crs =  32632)"
  },
  {
    "objectID": "day1_spatial.html#define-the-spde-model-pc-prior",
    "href": "day1_spatial.html#define-the-spde-model-pc-prior",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Define the SPDE model (PC prior)",
    "text": "Define the SPDE model (PC prior)\n\n\nCode\nspde &lt;- inla.spde2.pcmatern(\n  mesh = mesh,\n  prior.range = c(300000, 0.5),  # P(range &lt; 300 km) = 0.5\n  prior.sigma = c(1.0, 0.01)     # P(sigma &gt; 1) = 0.01\n)"
  },
  {
    "objectID": "day1_spatial.html#define-the-inlabru-components",
    "href": "day1_spatial.html#define-the-inlabru-components",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Define the inlabru components",
    "text": "Define the inlabru components\nWe model:\n\nFixed effects for elevation, ndvi, urban\nA spatial random field field(geometry, model = spde)\nAn intercept\n\n\n\nCode\ncomponents &lt;- ~\n  Intercept(1, model = \"linear\") +\n  beta_elev(elevation, model = \"linear\") +\n  beta_ndvi(ndvi, model = \"linear\") +\n  beta_urban(urban, model = \"linear\") +\n  field(geometry, model = spde)\n\nlik &lt;- like(family = \"binomial\", data = spatial_binom_sf, Ntrials = n_tested,\n            formula = n_pos  ~\n  Intercept +\n  beta_elev +\n  beta_ndvi +\n  beta_urban +\n  field)"
  },
  {
    "objectID": "day1_spatial.html#fit-the-spatial-binomial-model",
    "href": "day1_spatial.html#fit-the-spatial-binomial-model",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Fit the spatial binomial model",
    "text": "Fit the spatial binomial model\nResponse = n_pos, trials = n_tested, family = “binomial”.\n\n\nCode\nfit_spatial_binom &lt;- bru(\n  components = components,\n  lik,\n  options    = list(\n    control.compute = list(dic = TRUE, waic = TRUE, cpo = TRUE)\n  )\n)\n\nfit_spatial_binom\n\n\ninlabru version: 2.13.0.9024 \nINLA version: 25.12.02 \nLatent components:\nIntercept: main = linear(1)\nbeta_elev: main = linear(elevation)\nbeta_ndvi: main = linear(ndvi)\nbeta_urban: main = linear(urban)\nfield: main = spde(geometry)\nObservation models:\n  Model tag: &lt;No tag&gt;\n    Family: 'binomial'\n    Data class: 'sf', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban + field\n    Additive/Linear/Rowwise: TRUE/TRUE/TRUE\n    Used components: effect[Intercept, beta_elev, beta_ndvi, beta_urban, field], latent[] \nTime used:\n    Pre = 0.677, Running = 1.32, Post = 0.229, Total = 2.23 \nFixed effects:\n             mean    sd 0.025quant 0.5quant 0.975quant   mode kld\nIntercept  -0.875 0.120     -1.110   -0.875     -0.638 -0.875   0\nbeta_elev  -0.001 0.000     -0.001   -0.001      0.000 -0.001   0\nbeta_ndvi   0.418 0.119      0.183    0.418      0.651  0.418   0\nbeta_urban  0.023 0.087     -0.149    0.023      0.194  0.023   0\n\nRandom effects:\n  Name    Model\n    field SPDE2 model\n\nModel hyperparameters:\n                    mean       sd 0.025quant 0.5quant 0.975quant     mode\nRange for field 51121.69 8030.953   36682.60 50655.02   68203.95 50013.61\nStdev for field     1.26    0.109       1.07     1.26       1.50     1.24\n\nDeviance Information Criterion (DIC) ...............: 1850.10\nDeviance Information Criterion (DIC, saturated) ....: 640.78\nEffective number of parameters .....................: 191.37\n\nWatanabe-Akaike information criterion (WAIC) ...: 2348.40\nEffective number of parameters .................: 404.89\n\nMarginal log-Likelihood:  -1241.98 \nCPO, PIT is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')\n\n\nCode\nsummary(fit_spatial_binom)\n\n\ninlabru version: 2.13.0.9024 \nINLA version: 25.12.02 \nLatent components:\nIntercept: main = linear(1)\nbeta_elev: main = linear(elevation)\nbeta_ndvi: main = linear(ndvi)\nbeta_urban: main = linear(urban)\nfield: main = spde(geometry)\nObservation models:\n  Model tag: &lt;No tag&gt;\n    Family: 'binomial'\n    Data class: 'sf', 'tbl_df', 'tbl', 'data.frame'\n    Response class: 'numeric'\n    Predictor: n_pos ~ Intercept + beta_elev + beta_ndvi + beta_urban + field\n    Additive/Linear/Rowwise: TRUE/TRUE/TRUE\n    Used components: effect[Intercept, beta_elev, beta_ndvi, beta_urban, field], latent[] \nTime used:\n    Pre = 0.677, Running = 1.32, Post = 0.229, Total = 2.23 \nFixed effects:\n             mean    sd 0.025quant 0.5quant 0.975quant   mode kld\nIntercept  -0.875 0.120     -1.110   -0.875     -0.638 -0.875   0\nbeta_elev  -0.001 0.000     -0.001   -0.001      0.000 -0.001   0\nbeta_ndvi   0.418 0.119      0.183    0.418      0.651  0.418   0\nbeta_urban  0.023 0.087     -0.149    0.023      0.194  0.023   0\n\nRandom effects:\n  Name    Model\n    field SPDE2 model\n\nModel hyperparameters:\n                    mean       sd 0.025quant 0.5quant 0.975quant     mode\nRange for field 51121.69 8030.953   36682.60 50655.02   68203.95 50013.61\nStdev for field     1.26    0.109       1.07     1.26       1.50     1.24\n\nDeviance Information Criterion (DIC) ...............: 1850.10\nDeviance Information Criterion (DIC, saturated) ....: 640.78\nEffective number of parameters .....................: 191.37\n\nWatanabe-Akaike information criterion (WAIC) ...: 2348.40\nEffective number of parameters .................: 404.89\n\nMarginal log-Likelihood:  -1241.98 \nCPO, PIT is computed \nPosterior summaries for the linear predictor and the fitted values are computed\n(Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')\n\n\nYou’ll see posterior summaries for: - Intercept - beta_elev, beta_ndvi, beta_urban - SPDE hyperparameters (range, sigma)"
  },
  {
    "objectID": "day1_spatial.html#make-predictions-on-a-grid-prevalence-surface",
    "href": "day1_spatial.html#make-predictions-on-a-grid-prevalence-surface",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Make predictions on a grid (prevalence surface)",
    "text": "Make predictions on a grid (prevalence surface)\nWe start by loading the prediction grid with UTM coords and covariates. Also, convert it to sf object.\n\n\nCode\npred_grid &lt;- read_csv(\"data/prediction_grid_utm.csv\") %&gt;% \n  st_as_sf(coords = c(\"utm_x\", \"utm_y\"), crs =  32632)\n\n\n\n\nCode\n# Logistic helper\nlogistic &lt;- function(x) 1 / (1 + exp(-x))\n\n# Prediction: posterior mean of prevalence\npred_res &lt;- predict(\n  fit_spatial_binom,\n  newdata = pred_grid,\n  formula = ~ logistic(\n    Intercept +\n      beta_elev * elevation +\n      beta_ndvi * ndvi +\n      beta_urban * urban +\n      field\n  ),\n  n.samples = 1000   # increase for smoother estimates\n)\n\n# Combine predictions with grid\nnames(pred_res)[names(pred_res) == \"mean\"] &lt;- \"prev_mean\"\nnames(pred_res)[names(pred_res) == \"sd\"]   &lt;- \"prev_sd\""
  },
  {
    "objectID": "day1_spatial.html#plot-the-predicted-prevalence-surface",
    "href": "day1_spatial.html#plot-the-predicted-prevalence-surface",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Plot the predicted prevalence surface",
    "text": "Plot the predicted prevalence surface\n\n\nCode\n# ggplot(pred_res, aes(x = utm_x, y = utm_y, fill = prev_mean)) +\n#   geom_raster() +\n#   coord_equal() +\n#   scale_fill_viridis_c(name = \"Predicted\\nprevalence\") +\n#   theme_minimal() +\n#   labs(\n#     title = \"Posterior mean malaria prevalence\",\n#     subtitle = \"Spatial binomial model (inlabru, SPDE on UTM)\"\n#   )\n\n\nAnd (optionally) overlay the sampling locations:\n\n\nCode\n# ggplot() +\n#   geom_raster(\n#     data = pred_res,\n#     aes(x = utm_x, y = utm_y, fill = prev_mean)\n#   ) +\n#   geom_point(\n#     data = spatial_binom,\n#     aes(x = utm_x, y = utm_y),\n#     colour = \"black\", size = 0.6\n#   ) +\n#   coord_equal() +\n#   scale_fill_viridis_c(name = \"Predicted\\nprevalence\") +\n#   theme_minimal()"
  },
  {
    "objectID": "day1_spatial.html#exceedance-probability",
    "href": "day1_spatial.html#exceedance-probability",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Exceedance probability",
    "text": "Exceedance probability\nFirst, get posterior samples of prevalence on the grid.\n\n\nCode\n# # Recompute predictions but keep samples\n# pred_res_samples &lt;- generate(\n#   fit_spatial_binom,\n#   newdata = pred_grid,\n#   formula = ~ logistic(\n#     Intercept +\n#       beta_elev * elevation +\n#       beta_ndvi * ndvi +\n#       beta_urban * urban +\n#       field\n#   ),\n#   n.samples = 1000\n# )\n# \n# # pred_res_samples is a data.frame with summary stats\n# # and an attribute \".samples\" containing the draws\n# str(pred_res_samples)"
  },
  {
    "objectID": "day1_spatial.html#compute-exceedance-probability-pprevalence-0.3",
    "href": "day1_spatial.html#compute-exceedance-probability-pprevalence-0.3",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Compute exceedance probability P(prevalence > 0.3)",
    "text": "Compute exceedance probability P(prevalence &gt; 0.3)\n\n\nCode\n# # Extract sample matrix: rows = locations, cols = posterior samples\n# samples_mat &lt;- attr(pred_res_samples, \".samples\")\n# \n# # Check orientation (inlabru usually gives locations x samples)\n# dim(samples_mat)\n# \n# # Threshold\n# threshold &lt;- 0.3\n# \n# # Exceedance probability at each location\n# exc_prob &lt;- rowMeans(samples_mat &gt; threshold)\n# \n# # Add to prediction grid\n# pred_map_exc &lt;- dplyr::bind_cols(\n#   pred_grid,\n#   data.frame(\n#     prev_mean = pred_res_samples$mean,\n#     prev_sd   = pred_res_samples$sd,\n#     exc_prob_0.3 = exc_prob\n#   )\n# )"
  },
  {
    "objectID": "day1_spatial.html#plot-the-exceedance-probability-map",
    "href": "day1_spatial.html#plot-the-exceedance-probability-map",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Plot the exceedance probability map",
    "text": "Plot the exceedance probability map\n\n\nCode\n# ggplot(pred_map_exc, aes(x = utm_x, y = utm_y, fill = exc_prob_0.3)) +\n#   geom_raster() +\n#   coord_equal() +\n#   scale_fill_viridis_c(\n#     name = \"P(prev &gt; 0.3)\",\n#     limits = c(0, 1)\n#   ) +\n#   theme_minimal() +\n#   labs(\n#     title = \"Exceedance probability: P(prevalence &gt; 0.3)\",\n#     subtitle = \"Spatial binomial inlabru model\"\n#   )"
  },
  {
    "objectID": "day1_spatial.html#highlight-the-0.8-exceedance-contour",
    "href": "day1_spatial.html#highlight-the-0.8-exceedance-contour",
    "title": "Day 1 – Spatial & Spatio-temporal Modelling",
    "section": "Highlight the 0.8 exceedance contour",
    "text": "Highlight the 0.8 exceedance contour\n\n\nCode\n# ggplot(pred_map_exc, aes(x = utm_x, y = utm_y, fill = exc_prob_0.3)) +\n#   geom_raster() +\n#   coord_equal() +\n#   scale_fill_viridis_c(\n#     name = \"P(prev &gt; 0.3)\",\n#     limits = c(0, 1)\n#   ) +\n#   geom_contour(\n#     aes(z = exc_prob_0.3),\n#     breaks = 0.8,\n#     colour = \"red\",\n#     linewidth = 0.6\n#   ) +\n#   theme_minimal() +\n#   labs(\n#     title = \"Exceedance probability with 0.8 contour\",\n#     subtitle = \"Red line: P(prev &gt; 0.3) = 0.8\"\n#   )"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Geostatistical Modelling with inlabru",
    "section": "",
    "text": "This workshop is funded by the London Mathematical Society (LMS) Scheme 5.\n\nWelcome to the Geostatistical Modelling with inlabru workshop.\nThis 3-day workshop covers:\n\nSpatial and spatio-temporal analysis (different likelihoods)\nJoint modelling of multiple malaria processes\nNon-stationary spatial processes\nHybrid machine learning + geostatistical models"
  },
  {
    "objectID": "day2.html",
    "href": "day2.html",
    "title": "Day 2 – Joint modelling and Non-stationary processes",
    "section": "",
    "text": "Today we will cover two key advanced topics in spatial modelling:\n\nJoint modelling of multiple malaria processes\n\nShared spatial fields\n\nProcess-specific fields\n\nMultiple outcomes (e.g., children vs pregnant women)\n\nNon-stationary spatial processes\n\nRegion-varying smoothness\n\nCovariate-driven nonstationarity\n\nCombining multiple spatial SPDEs"
  },
  {
    "objectID": "day2.html#overview",
    "href": "day2.html#overview",
    "title": "Day 2 – Joint modelling and Non-stationary processes",
    "section": "",
    "text": "Today we will cover two key advanced topics in spatial modelling:\n\nJoint modelling of multiple malaria processes\n\nShared spatial fields\n\nProcess-specific fields\n\nMultiple outcomes (e.g., children vs pregnant women)\n\nNon-stationary spatial processes\n\nRegion-varying smoothness\n\nCovariate-driven nonstationarity\n\nCombining multiple spatial SPDEs"
  },
  {
    "objectID": "day2.html#load-day-2-datasets",
    "href": "day2.html#load-day-2-datasets",
    "title": "Day 2 – Joint modelling and Non-stationary processes",
    "section": "Load Day 2 datasets",
    "text": "Load Day 2 datasets\n\n\nCode\nlibrary(tidyverse)\n\njoint_malaria &lt;- read_csv(\"data/joint_malaria_processes.csv\")\nnonstat_malaria &lt;- read_csv(\"data/nonstationary_malaria_data.csv\")\n\nhead(joint_malaria)\n\n\n# A tibble: 6 × 12\n     id group    utm_x  utm_y n_tested n_pos prevalence_true S_shared S_specific\n  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n1     1 childr… 2.71e5 6.47e5      156    68           0.470   0.680     -0.0220\n2     2 childr… 1.03e6 1.07e6      199    57           0.253  -0.0229    -0.324 \n3     3 childr… 1.03e6 1.23e6       83    18           0.216  -0.600     -0.428 \n4     4 childr… 8.62e5 1.11e6      193   137           0.712   0.976     -0.236 \n5     5 childr… 8.08e4 8.40e5       76    45           0.491   0.656     -0.286 \n6     6 childr… 5.42e5 9.87e5      117    61           0.552   1.42      -0.266 \n# ℹ 3 more variables: elevation &lt;dbl&gt;, ndvi &lt;dbl&gt;, urban &lt;dbl&gt;\n\n\nQuick visualisation\n\n\nCode\nlibrary(ggplot2)\n\nggplot(joint_malaria, aes(utm_x, utm_y, colour = group)) +\ngeom_point() +\ncoord_equal() +\ntheme_minimal()\n\n\n\n\n\n\n\n\n\nQuick visualisation (non-stationary dataset)\n\n\nCode\nggplot(nonstat_malaria, aes(utm_x, utm_y, colour = prevalence_true)) +\ngeom_point() +\ncoord_equal() +\nscale_colour_viridis_c() +\ntheme_minimal()"
  },
  {
    "objectID": "day3.html",
    "href": "day3.html",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "",
    "text": "Today we combine:\n\nMachine learning models (e.g., Random Forest, XGBoost)\nSpatial residual modelling via SPDE + inlabru\nHybrid prediction pipelines for malaria prevalence\n\nThe goal:\nUse ML to model complex covariate effects, and INLA/SPDE to model spatial dependence in the residuals."
  },
  {
    "objectID": "day3.html#overview",
    "href": "day3.html#overview",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "",
    "text": "Today we combine:\n\nMachine learning models (e.g., Random Forest, XGBoost)\nSpatial residual modelling via SPDE + inlabru\nHybrid prediction pipelines for malaria prevalence\n\nThe goal:\nUse ML to model complex covariate effects, and INLA/SPDE to model spatial dependence in the residuals."
  },
  {
    "objectID": "day3.html#load-day-3-dataset",
    "href": "day3.html#load-day-3-dataset",
    "title": "Day 3 – Hybrid Machine Learning + Geostatistics",
    "section": "Load Day 3 dataset",
    "text": "Load Day 3 dataset\n\n\nCode\nlibrary(tidyverse)\n\nhybrid_ml_geo &lt;- read_csv(\"data/hybrid_ml_geostatistical_data.csv\")\n\nhead(hybrid_ml_geo)\n\n\n# A tibble: 6 × 11\n     id    utm_x    utm_y n_tested n_pos prevalence_true ml_signal_true\n  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;\n1     1  387215. 1485399.       59     0     0.000334            -7.06 \n2     2 1046370.  758144.      180     8     0.0496              -1.66 \n3     3  681525. 1102741.      164    22     0.167               -0.980\n4     4  713355. 1127489.       62     0     0.00476             -4.17 \n5     5  276748. 1384709.       84     0     0.00000423         -11.6  \n6     6 -112576. 1315376.       60     0     0.000000669        -12.5  \n# ℹ 4 more variables: S_residual_true &lt;dbl&gt;, elevation &lt;dbl&gt;, ndvi &lt;dbl&gt;,\n#   urban &lt;dbl&gt;\n\n\nVisualise ML signal + spatial residuals\n\n\nCode\nlibrary(ggplot2)\n\nggplot(hybrid_ml_geo, aes(utm_x, utm_y, colour = ml_signal_true)) +\ngeom_point() +\ncoord_equal() +\ntheme_minimal()"
  },
  {
    "objectID": "slides/day2_slides.html#todays-focus",
    "href": "slides/day2_slides.html#todays-focus",
    "title": "Day 2 – Joint Modelling + Non-stationarity",
    "section": "Today’s Focus",
    "text": "Today’s Focus\n\nJoint models\nShared vs group-specific fields\nNon-stationary spatial processes"
  },
  {
    "objectID": "slides/day2_slides.html#load-datasets",
    "href": "slides/day2_slides.html#load-datasets",
    "title": "Day 2 – Joint Modelling + Non-stationarity",
    "section": "Load Datasets",
    "text": "Load Datasets\n\nlibrary(readr)\n\njoint_malaria &lt;- read_csv(\"../data/joint_malaria_processes.csv\")\nnonstat_malaria &lt;- read_csv(\"../data/nonstationary_malaria_data.csv\")\nhead(joint_malaria)\n\n# A tibble: 6 × 12\n     id group    utm_x  utm_y n_tested n_pos prevalence_true S_shared S_specific\n  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;           &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;\n1     1 childr… 2.71e5 6.47e5      156    68           0.470   0.680     -0.0220\n2     2 childr… 1.03e6 1.07e6      199    57           0.253  -0.0229    -0.324 \n3     3 childr… 1.03e6 1.23e6       83    18           0.216  -0.600     -0.428 \n4     4 childr… 8.62e5 1.11e6      193   137           0.712   0.976     -0.236 \n5     5 childr… 8.08e4 8.40e5       76    45           0.491   0.656     -0.286 \n6     6 childr… 5.42e5 9.87e5      117    61           0.552   1.42      -0.266 \n# ℹ 3 more variables: elevation &lt;dbl&gt;, ndvi &lt;dbl&gt;, urban &lt;dbl&gt;"
  }
]